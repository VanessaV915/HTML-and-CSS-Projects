f3e.prototype.lra=W(1488,function(){return[]});f3e.prototype.Yqa=W(1487,ea("Answers feedback"));vW.prototype.WK=W(1486,ea(10));RW.prototype.WK=W(1485,g("Pa"));TW.prototype.WK=W(1484,g("D"));G8e.prototype.WK=W(1483,ea(10));xXe.prototype.Dca=W(1482,ea(null));f3e.prototype.Dca=W(1481,g("F"));var CRf={1:Oja,2:Uf},DRf={2:{1:[{1:[CRf],2:CRf}]}};function ERf(a,b){return L(a,1,b)}function FRf(a,b){L(a,2,b)}function GRf(a,b){D(a,1,b)}function HRf(a){var b=Ka();L(a,3,b)}
function IRf(a,b,c){var d=Xj(a.C,xT,1),e=new xT;L(e,1,b);L(e,2,c);L(e,4,0);HRf(e);d.push(e);ud(d,function(f,h){return(h.Wi()||0)-(f.Wi()||0)});rd(d,void 0,function(f){return K(f,1)+", "+f.hb()});ak(a.C,1,qd(d,0,a.R));Gle(a)}function JRf(a){return a.D["ritz-ShouldDisplaySmartFillSurvey"]}function KRf(a,b){a.C.Ha=b}function LRf(a,b){a=a.C;a.Pa=b;null==a.Ca||a.Pa.includes(a.Ca)||mP(a)}function MRf(a){Yn.call(this,a)}t(MRf,Yn);MRf.prototype.hasType=function(){return this.message.hasType()};
MRf.prototype.getType=function(){return this.message.getType()};MRf.prototype.setType=function(a){return fo(this,1,a)};MRf.prototype.clearType=function(){return $n(this,1)};function NRf(a){this.Dd=Kn(a,-1,0)}t(NRf,On);NRf.prototype.mf=function(){return new MRf(this)};NRf.prototype.hasType=function(){return Rn(this,1)};NRf.prototype.getType=function(){return Vn(this,1,0)};function ORf(a,b,c){PJ.call(this,156);this.gb=a;this.F=b;this.C=c}t(ORf,PJ);
ORf.prototype.Ed=function(){var a=new sSb;this.C.forEach(function(b){var c=C(b,1),d=new Kr;b=b.getValue();D(d,3,b);b=new Lr;var e=c.Aj();D(b,1,e);c=c.getColumnIndex();D(b,2,c);D(b,3,d);Ug(a,2,b)});GRf(a,mo(this.F,this.gb.Fb()));return a};ORf.prototype.wg=ea(!1);
function PRf(a,b){var c=a.D.ob(b);return new Wp(function(d,e){Pl(Ql(Wq(Ol(fr(gr(a.C.Re("/smartFill/getSuggestion"),"POST")),1).setTimeout(3E4),["data",Nm(c)]),function(f){f=a.D.Hd(DS.getDescriptor(),f.He());1!=f.getStatus()&&e(f);d(f)}),function(){var f=new DS;D(f,1,2);e(f)}).Me()})}function QRf(a){A.call(this);this.D=a;this.C=JRf(this.D.F).getValue()}t(QRf,A);
function RRf(a){a.C&&JRf(a.D.F).getValue()?(NA.getInstance().postMessage(QA("Please take a quick 3 question survey about SmartFill","Take survey",function(){Xe("https://google.qualtrics.com/jfe/form/SV_5pEvy5W5UY82FjT")},"promo",void 0,void 0)),a.C=!1,JRf(a.D.F).setValue(!1)):a.C=!1}function SRf(a){a.C&&fq(function(){return RRf(a)},6E4)}function TRf(a,b,c,d){this.C=a;this.F=b;this.D=c;this.H=d}TRf.prototype.hj=g("F");TRf.prototype.Ad=g("H");
TRf.prototype.equals=function(a){if(!a||this.C!=a.C)return!1;if(null!=this.Ad()){if(!a.Ad()||this.Ad().length!=a.Ad().length)return!1;for(var b=0;b<this.Ad().length;b++)if(!this.Ad()[b].equals(a.Ad()[b]))return!1;return!0}return this.hj()==a.hj()};function URf(a){var b=WEd.getInstance(),c=a.rect;return c?(a=b.C[a.C])?a[c.left+c.width-1]||null:null:null}
function VRf(a,b){var c=WEd.getInstance(),d=a.rect;if(d){a=a.C;var e=c.C[a];if(e){d=d.left+d.width-1;var f=e[d]||null;$d(e,d);b&&f&&(b=c.D[a],b||(b={},c.D[a]=b),c=b[d],c||(c=[],b[d]=c),c.push(f))}}}function WRf(a,b){var c=b.rect;return c?(a=a.D[b.C])?a[c.left+c.width-1]||[]:[]:[]}function XRf(a,b){var c=WEd.getInstance();return!!bd(WRf(c,a),function(d){return b.equals(d)})}function YRf(a){var b=a.F.C,c=b.C;return hrc(a.F)?xI(b,a.F.Na):c}function ZRf(a){return(a=UJ(a.C))?a.H:null}
function $Rf(a){return a.D.isEnabled()||gJ(a.D)}function m_(a,b,c,d,e,f){var h=vz(new uz,22);c&&(c=1E3*((new Date).getTime()-c),c=wk(new vk,c),xz(vz(h,41),c));c=new w8d;d&&L(c,1,d);e&&Yj(c,2,e);f&&L(c,3,f);d=new Bk;d=Yj(d,31,c);yz(h,d);a.xa.C(b,zz(h))}
function aSf(a,b){if(z(y(),"femfs")&&Sg(b,1)){var c=(new Date).getTime();PRf(a.hCa,b).then(function(d){var e=C(d,4);m_(a,36766,c,e);var f=C(d,2),h=Xg(d,5);d=h&&0<h.length?new TRf(e,null,null,h):d.hj()?new TRf(e,d.hj(),C(d,7),null):null;h=no(f);if(d&&!XRf(h,d)&&(f=WEd.getInstance(),e=h.rect)){h=h.C;var k=f.C[h];k||(k={},f.C[h]=k);k[e.left+e.width-1]=d}},function(d){var e=void 0;d instanceof DS&&Sg(d,6)&&(e=C(d,6));m_(a,36767,c,void 0,void 0,e)})}}
function bSf(a,b){b=b.D;b=mn(b.Aj(),b.getColumnIndex());a=Qke(a,b,["S","W"]);return new jn(a.Lb(),a.Qc()-1,a.Oc(),a.Qc())}function cSf(a){return(a=ZRf(a))?a.Pa:null}function dSf(a,b){b=void 0===b?!1:b;var c=UJ(a.C);c&&(ritz_api.GridViewApi.removeSmartFillSuggestion(c.L.J),(a=cSf(a))&&a.Fe(),b&&c.Jc())}
function eSf(a,b,c,d,e,f,h,k,l,n){A.call(this);this.F=a;this.C=b;this.O=c;this.xa=d;this.Wa=e;this.hCa=VEd.getInstance();this.H=new Cl;this.R=h;this.V=k;this.ma=n;(this.D=z(y(),"fess")?new QRf(this.F):null)&&this.qa(this.D);this.J=new Wo(this);this.qa(this.J);this.L=new uA(this);this.qa(this.L);a=RG(this.O);this.J.listen(this.C,"inputBoxDeactivate",this.a5b).listen(this.C,"inputBoxActivate",this.$4b).listen(a,["oc","pc","qc","rc"],this.b5b);z(y(),"femfs")&&(uBb.Ma(!0),uBb.setVisible(!0),l.C(tBb,YEd).F(tBb,
YEd).C(vBb,YEd).F(vBb,YEd));z(y(),"femfs")&&this.L.subscribe(tBb,"action",this.$ob).subscribe(vBb,"action",this.JQa).subscribe(uBb,"action",this.c5b)}t(eSf,A);m=eSf.prototype;
m.a5b=function(a){if(a.ma){a=(new Date).getTime();var b=YRf(this),c=UJ(this.C);if(b&&c){var d=ZRf(this);if(d&&!d.H.L){var e=rO(d);if(e&&e.getValue()&&e.Lc!=e.getValue()&&!kF(e.getValue())){var f=b.zc();if(!$Rf(f)&&(d=f&&nI(f,rO(d).Ds))&&0!=d.x){var h=new Jn(b.hb(),ln(d));if(URf(h))a=ritz_api.GridViewApi.getSmartFillSuggestionValueAt(c.L.J,b.hb(),d.y,d.x),""!=e.getValue()&&a&&e.getValue()!=a&&this.JQa();else{e=WEd.getInstance();if(e=!(3<=WRf(e,h).length))a:{for(e=1;10>=e;e++)if(c=f,h=new Qm(d.x,d.y+
e),0>h.x||0>h.y?0:UI(QI(c,h),c.Fb(),h.y,h.x)){e=!1;break a}e=!0}if(e){b=ritz_api.RitzModelApi.getSmartFillRequestTriggerResult(b.hb(),d.y,d.x);b=Dl(b,DRf);b=this.H.Hd(TEd.getDescriptor(),b);a:switch(C(b,1)){case 3:m_(this,36754,a);a=!0;break a;case 4:m_(this,36755,a);a=!1;break a;case 2:m_(this,36757,a);a=!1;break a;default:m_(this,36756,a),a=!1}a&&aSf(this,b.Fm())}}}}}}}dSf(this,!0)};
m.$4b=function(){var a=this,b=YRf(this),c=UJ(this.C);if(b&&c){var d=ZRf(this);if(d&&!d.H.L&&rO(d)){var e=b.zc();if(!$Rf(e)){var f=e&&nI(e,rO(d).Ds);if(f)if(f=new Jn(b.hb(),ln(f)),(f=URf(f))&&f.D){e=bSf(e,f);var h=new Jn(b.hb(),e);b=(new Date).getTime();if(f.hj()){var k=f.hj();var l=El(this.H.ob(f.D),Oja);k=this.R.getCalculatedSmartFillSuggestion(LSe(h).ob(),k.startsWith("=")?k:"="+k,l)}else k=ritz_api.GridViewApi.getSmartFillSuggestionForValues(f.Ad().map(function(n){return El(a.H.ob(n),CRf)}));if(k){if(h=
cSf(this))h.H=!0,h.D=d.O,h.D.V?h.F=null:h.F=h.D==d.C?d.L:null,PPc(h,!0);ritz_api.GridViewApi.updateSmartFillModel(c.L.J,k);c.Jc();d=new u8d;FRf(ERf(d,e.Oc()-e.Lb()),ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(c.L.J));m_(this,36773,b,f.C,d);OJ("SmartFill suggestion shown. Preview added to cells in range {"+(yM(e)+"}"))}else dSf(this),VRf(h,!0)}else dSf(this,!0)}}}};
m.$ob=function(){var a=this,b=YRf(this),c=b.zc();if(!$Rf(c)){var d=c.F,e=new Jn(b.hb(),d),f=URf(e);if(f){var h=bSf(c,f),k=void 0;if(b=UJ(this.C))k=ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(b.L.J),vO(b,!1);var l,n=f.Ad();n?l=new ORf(c,h,f.Ad()):l=new mvd(c,h,f.hj());QJ(l,function(q){q&&(dSf(a,!0),VRf(e,!1),q=new u8d,ERf(q,h.Oc()-h.Lb()),k&&FRf(q,k),m_(a,36777,void 0,f.C,q),(q=UJ(a.C))&&rRc(q,n?"Cells filled with public data.":"Cells filled with a formula.","Send feedback",function(){(Wt(),
Rv).kb({source:"smartfill"})}),a.D&&SRf(a.D))});this.V.C(l)}}};m.JQa=function(){var a=YRf(this),b=a.zc();if(!$Rf(b)){var c=b.F;a=new Jn(a.hb(),c);var d=URf(a);if(d){b=Qke(b,c,["N","S","W"]);c=new u8d;ERf(c,b.Oc()-b.Lb());var e=UJ(this.C);e&&FRf(c,ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(e.L.J));m_(this,36778,void 0,d.C,c);dSf(this,!0);VRf(a,!0);OJ("SmartFill suggestion rejected for range ("+(yM(b)+")."));this.D&&SRf(this.D)}}};
m.c5b=function(){var a=YRf(this),b=a.zc().F;a=new Jn(a.hb(),b);URf(a)&&(a=cSf(this))&&a.H&&(a.Ka().focus(),this.ma.zb(2))};m.b5b=function(){var a=YRf(this);a&&(a=a.zc(),$Rf(a)&&dSf(this))};function fSf(a,b){var c=Rn(a,1)?jo(a):Number.MIN_VALUE;a=Rn(a,2)?Un(a,2):Number.MAX_VALUE;var d=Rn(b,1)?jo(b):Number.MIN_VALUE;b=Rn(b,2)?Un(b,2):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function gSf(a){return Zn(BCa(zCa(),a))}
function hSf(a,b,c){var d=a.Oc(),e=a.Qc();switch(b){case 0:d=Math.min(d,a.Lb()+c);break;case 1:e=Math.min(e,a.Kb()+c)}return dTb(a.hb(),a.Lb(),a.Kb(),d,e)}
function iSf(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function jSf(a,b){return S(R(CA({Yc:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:Fx(""+R(QB({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(CA({Yc:"waffle-assistant-zoom-button",content:Fx(""+R(QB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function kSf(a,b,c,d,e,f,h){jX.call(this,a,b,c,$R.getInstance(),"regular",e,f,h);this.Oa=d;this.R=new Dz(null,new yR,this.oa());this.Fa(this.R);a=a.C;c=new tO(c,!0,!0);this.V=new I8e(a,new m4e(c),b);this.V.Aa=this.F;b=Zn(go(jec(gec(),!0),12,uqb));this.Sa=new G9e(b);this.D=this.xa=null;this.ma=[]}t(kSf,jX);m=kSf.prototype;m.Bc=function(a){jX.prototype.Bc.call(this,a);this.R.Ua(this.oa().Za("waffle-answers-button"))};
m.Ga=function(){jX.prototype.Ga.call(this);this.getHandler().listen(this.Oa,"selectionChange",this.OWb)};m.eWa=function(a){this.V.L=a;this.O.qE(a)};m.QX=function(){jX.prototype.QX.call(this);this.getHandler().listen(this.R,"action",this.Zpb);lSf(this)};m.bG=function(){var a=this.J;return HI(a.C)?CWe(a)?jX.prototype.bG.call(this):!1:!1};m.Ma=function(a){jX.prototype.Ma.call(this,a);sW(this.R.getElement(),a?"":this.Yba());this.R.Ma(a)};
m.ZKa=function(){if(this.D){var a=io(ritz_api.TablesApi.getTableGridRange(this.D));a=KG(a);return Z1e(a,DI(this.J.C))}return null};m.RBa=function(){if(this.D){var a=io(ritz_api.TablesApi.getTableGridRange(this.D));if(50>LG(a).height)return!1}a=gp("docs-titlebar-buttons");a=a.offsetWidth+ox(a).right;return(hx(this.H.getElement())?a:a+200)+700<=window.innerWidth};m.Yba=ea("Answers is unavailable, try using Explore");
m.vO=function(){jX.prototype.vO.call(this);var a=D9e(this),b=this.RBa();this.R.setVisible(!b&&a)};m.Zpb=function(){X0e(null,this.ma,null,this.F)};m.KRa=function(a){X0e(a,this.ma,null,this.F)};m.OWb=function(){mSf(this)&&lSf(this)};m.pua=function(){var a=jX.prototype.pua.call(this);a&&(this.D=null,mSf(this)&&lSf(this));return a};function mSf(a){a=a.J;return HI(a.C)&&IM(a)}
function lSf(a){if(a.bG()){var b=a.J.C,c=KI(b),d=Yqd(c);if(0<d.length)b=io(ritz_api.TablesApi.getTableGridRange(d[0])),a.D&&b.equals(io(ritz_api.TablesApi.getTableGridRange(a.D)))||(a.D=d[0],a.Z8());else if(null!=a.D){d=io(ritz_api.TablesApi.getTableGridRange(a.D));b=d.hb()!=DI(b);var e=!1;if(!b){var f=yJ(c);c=ritz_api.TablesApi.getCurrentlyDetectedTables(JG(f,c.Fb()).ob());c=ja(c);for(f=c.next();!f.done;f=c.next())if(f=io(ritz_api.TablesApi.getTableGridRange(f.value)),f==d||null!=f&&f.equals(d)){e=
!0;break}}if(b||!e)a.D=null,a.L.C(36726,E9e(a)),a.Z8()}}else a.$B()}m.Z8=function(){var a=this;this.$B();if(this.D){var b=io(ritz_api.TablesApi.getTableGridRange(this.D)),c=[KG(b)];null!=this.xa&&this.xa.cancel();5E4<L0e(b)?this.L.C(36727,E9e(this)):(this.xa=H9e(this.Sa,c),this.xa.then(function(d){a.pb()&&nSf(a,d.C)}).wh(function(){a.$B()}))}};
function nSf(a,b){a.ma=b;var c=null;b=ja(b);for(var d=b.next();!d.done;d=b.next())d=d.value,3==Yg(d,1)&&(c=d);if(c&&.6<C(c,2)){a.L.C(36728,E9e(a));b=C(c,9)||new CJ;var e=Yc(Xg(b,1),function(l){return l.getName()}),f=[],h=[];d=ja(Xg(b,2));for(var k=d.next();!k.done;k=d.next())k=k.value,f.push(k.getName()),h=h.concat(Xg(k,2));d=no(HV(c));k=Sg(c,11)?C(c,11):null;c=null==k?null:no(C(c,10));a.V.init(b,d,c,k,[],[]);a.V.XY();a.V.YY().then(function(l){var n=h;l=void 0===l?[]:l;(e.length||f.length||n.length||
l.length)&&a.Ma(!0);a.O.n_(e,f,n);0<l.length&&(a.O.eO(l),z(y(),"feaipu")&&a.C&&a.C.D.setAttribute("placeholder","Try '"+(l[0].query+"'")));a.C&&y7e(a.C)})}Y0e(a.ma,null,a.F)}m.$B=function(){jX.prototype.$B.call(this);this.ma=[];this.V.reset();Y0e(null,null,this.F)};function oSf(a,b){rS.call(this,void 0,b,!1,!0);this.H=a;this.setTitle("Additional info");this.C.setVisible(!1)}t(oSf,rS);
oSf.prototype.Ba=function(){var a=this;rS.prototype.Ba.call(this);ky(this.Ka(),"waffle-assistant-feedback-product-info-dialog");var b=Object.keys(this.H).map(function(c){var d=a.H[c];return Le("DIV",void 0,[Le("DT",void 0,c+":"),Le("DD",void 0,String(d))])});zy(this,Me(b))};function pSf(a){var b=a.XS,c=a.index,d=a.checked;return S(R(VR({Yc:"waffle-assistant-feedback-dialog-radio-button",name:Fx(""+R(a.name)),label:b,checked:d,value:c+1},void 0)))}
function qSf(){var a='<div class="'+T("waffle-assistant-feedback-dialog-legal")+'"><small><div class="'+T("waffle-assistant-feedback-dialog-legal-information-text")+'">';a=a+'We will use the information you give us to help address technical issues and to improve our services, subject to our  <a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" class="uf-legal-link">Privacy Policy </a>   and  <a href="https://www.google.com/intl/en/policies/terms/" target="_blank" class="uf-legal-link">Terms of Service</a> .</div><div class="'+
(T("waffle-assistant-feedback-dialog-product-info-display-text")+'"><span tabindex="0" role="link">');return S(a+"What will be shared with Google?</span></div></small></div>")}function rSf(a,b){rS.call(this,void 0,b,!0,!0);this.R=a;this.L=a.oya();this.ma=a.lra();this.H=this.V=this.O=null;this.setTitle(a.Yqa());this.C.setContent("Submit")}t(rSf,rS);m=rSf.prototype;
m.Ba=function(){rS.prototype.Ba.call(this);ky(this.Ka(),"waffle-assistant-feedback-dialog");var a=this.L.length,b=this.R.rra();var c=this.ma;var d="";if(0<a){d+='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d=d+'Recent suggestions</div><div class="'+(T("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")+'">');a=Math.max(0,Math.ceil(a));for(var e=0;e<a;e++){var f=e;d+=pSf({name:"waffle-assistant-feedback-dialog-suggestions-radio-buttons",XS:"",checked:f==b,index:f})}d+=
"</div>"}d+='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d+="Issue</div>";if(0<c.length){d+='<div class="'+T("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")+'">';b=c.length;for(a=0;a<b;a++)d+=pSf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",XS:c[a],checked:!1,index:a});d+=pSf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",XS:"Other",checked:!1,index:c.length});d+="</div>"}d+='<div class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea-wrapper")+
'"><textarea class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea")+" "+T("jfk-textinput")+'" placeholder="'+T("Tell us a bit more")+'"></textarea></div>';c=S(d);zy(this,Ax(c));c=By(this);this.oa().Ts(c,Uy(qSf),0)};
m.Ga=function(){var a=this;rS.prototype.Ga.call(this);if(0<this.L.length){this.O=l5e("waffle-assistant-feedback-dialog-suggestions-radio-buttons",this.Ea("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control"));this.qa(this.O);for(var b=0;b<this.L.length;b++){var c=this.L[b];QW(this.O,b).cI(this.R.render(c))}}0<this.ma.length&&(this.V=l5e("waffle-assistant-feedback-dialog-feedback-radio-buttons",this.Ea("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")),this.qa(this.V));
b=this.Ea("waffle-assistant-feedback-dialog-product-info-display-text");c=new bz(b);this.qa(c);this.getHandler().listen(b,"click",this.tRa).listen(c,"key",function(d){13===d.keyCode&&(a.tRa(),d.stopPropagation())})};m.Kz=function(){var a=sSf(this);Tsb.kb(a,a.gYa);var b=this.R.Dca();b&&b(a);rS.prototype.Kz.call(this)};
function sSf(a){var b=null;a.O&&(b=parseInt(h5e(a.O),10)-1,b=a.L[b]);var c=-1;a.V&&(c=parseInt(h5e(a.V),10)-1);var d=a.Ea("waffle-assistant-feedback-dialog-other-feedback-textarea");d=Hd(d.value)||"[No feedback entered]";return a.R.nya(b,c,d)}m.tRa=function(){var a=this,b=sSf(this).Bha;this.H=new oSf(b,this.oa());this.H.setVisible(!0);this.getHandler().listen(this.H,"hide",function(){Qf(a.H);a.H=null})};m.Ia=function(){rS.prototype.Ia.call(this);Qf(this.H)};
function tSf(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function uSf(a,b){return S(R(CA({Yc:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Fx(""+R(QB({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(CA({Yc:"waffle-assistant-zoom-button",content:Fx(""+R(QB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}function vSf(a,b,c,d){Q.call(this,d);this.O=a;this.D=b;this.C=c;zz(vz(new uz,10))}t(vSf,Q);
vSf.prototype.hPa=function(a,b){this.F(this.O,2746,a,b)};
function wSf(a){var b=a.jkb,c='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',d='By <span class="waffle-assistant-facet-title">'+(R(a.Acb)+"</span>");a=0==b.length;c=c+d+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(a)b=S('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');else{d=
'<div class="waffle-assistant-facet-charts-container">';for(var e=b.length,f=0;f<e;f++){var h=b[f];d+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';d=h?d+R(h):d+"(empty)";d+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}b=S(d+"</div>")}c+='<div class="waffle-assistant-facet-content-wrapper'+(a?" waffle-assistant-facet-white-section":"")+'">'+
b+(RC?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return S(c)}function xSf(){k2c.apply(this,arguments)}t(xSf,k2c);xSf.prototype.esa=g("element");function ySf(){$1c.call(this);a2c(this,this);this.xa="waffle-assistant-dragged-card"}t(ySf,CQ);ySf.prototype.contains=function(a){return!!Vc(this.F,function(b){if(b.element==a)return!0})};
ySf.prototype.a4=function(a){var b=CQ.prototype.a4.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function zSf(a,b,c,d,e,f,h,k,l,n){vSf.call(this,e,f,h,n);this.V=a;this.L=b;this.ma=c;this.H=d;this.R=k;this.J=l}t(zSf,vSf);zSf.prototype.Ga=function(){vSf.prototype.Ga.call(this);P6e(this.ma,this.Ka(),this.D,this.C,void 0,void 0,this.H)};
zSf.prototype.F=function(a,b,c,d){KI(this.V).dispatchEvent(new u4e(this.L.copy(),this.H,a,b,c,d,void 0,this.R,this.J))};function ASf(a,b,c,d,e,f){vSf.call(this,c,d,e,f);this.R=a;this.J=b;this.H=null}t(ASf,vSf);ASf.prototype.Ga=function(){vSf.prototype.Ga.call(this);(new QV(vpc,this.J.Il)).send(u(this.L,this,this.J))};ASf.prototype.F=function(a,b,c,d){this.dispatchEvent(new v4e(this.R.clone(),a,this.H,b,c,d))};
ASf.prototype.L=function(a,b){if(b)if(b.Dk())WL.NJ(this.Ka(),b);else{a.Kj(b.Ne());LW(a,a.Ne());var c=(b=a.Ne())?b.toJSON():null,d=ritz.charts.model.GvizChart.create();d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);P6e(d,this.Ka(),this.D,this.C,void 0,void 0,void 0);this.H=b}};
function BSf(a,b,c,d,e,f,h,k){Q.call(this,k);this.C=a;this.Sa=b;this.Ja=c;this.Pa=d;this.R=e;this.Ha=f;this.Oa=h;this.H=Xg(this.C,23);this.O=C(this.C,22);this.F=C(this.C,26);this.V=[];this.Na=new Cl;this.xa=this.L=this.D=null;this.Aa=!1;this.Ca=new DA("",this.oa());this.Fa(this.Ca);this.J=this.ma=null}t(BSf,Q);m=BSf.prototype;m.Ba=function(){Q.prototype.Ba.call(this);this.jb(Uy(wSf,{Acb:this.F,jkb:this.H}));this.Ka().style.visibility="hidden"};
m.Ga=function(){Q.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-facet-toggle");this.Ca.Ua(a);this.getHandler().listen(this.Ka(),"mousedown",this.KWb).listen(this.Ca,"action",this.aLb);RC&&(this.xa=new T2e("assistantAutovisFacetFeedback",null,"",this.oa()),this.xa.render(this.Ea("waffle-assistant-facet-feedback-container")),this.D=new Y2e(this.oa()),this.Fa(this.D),this.D.render(this.Ea("waffle-assistant-facet-thumbs-container")),Z2e(this.D,this.H.length?"Were these charts useful?":"Was this chart useful?"),
this.getHandler().listen(this.D,"thumbs-up",this.SKb).listen(this.D,"thumbs-down",this.RKb));CSf(this,z(y(),"fefsbd"))};m.Ld=g("Aa");m.KWb=function(a){a.stopPropagation()};m.aLb=function(){var a=jy(this.Ea("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");CSf(this,a);DSf(this,a?2647:2646)};
function CSf(a,b){var c=a.Ea("waffle-assistant-facet-toggle");Gp(c,b?"HIDE":"SHOW");oy(a.Ea("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);Vc(a.Qf("waffle-assistant-faceted-chart"),function(e){Hp(e,b)});a.D&&P(a.D.Ka(),b);var d='Show chart broken down by "'+(a.F+'"');a='Hide chart broken down by "'+(a.F+'"');sW(c,b?a:d)}
function ESf(a,b){var c=a.Qf("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=C(a.C,28).clone();Vg(d,1);for(var e=Xg(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f="string"===typeof a.H[e]?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=n1e(h));h.setTitle(FSf(k,l,f));k=h.copy();l=El(a.Na.ob(d),ng);k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(l));R6e(k);l=new zSf(a.Sa,
h,k,d,a.Ja,a.Pa,a.R,C(a.C,29),a.Oa,a.oa());a.Fa(l);var n=c[e];l.Ua(n);a.V.push(l);GSf(a,n,n1e(h),f);a.ma=k}HSf(a);a.Ka().style.visibility="visible"}function GSf(a,b,c,d){var e=c+(' broken down by "'+(a.F+('" for "'+(d+'"'))));a=c+(' broken down by "'+(a.F+'"'));Xx(b,d?e:a)}function FSf(a,b,c){var d=b+(' when "'+(a.F+('" is "'+(c+'"'))));a=b+(' by "'+(a.F+'"'));return c?d:a}
function ISf(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.ye()&&a.setOption("isStacked",!0)}function JSf(a){"BarChart"==a.ye()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function HSf(a){a.Aa||Vc(a.V,function(b){var c=b.Ka();if(!a.Ha.contains(c)){var d=a.Ha;b=new xSf(c,b);b4c(d,b)}})}m.SKb=function(){DSf(this,2649)};m.RKb=function(){DSf(this,2648);this.xa.show(!0)};function DSf(a,b){if(a.ma)yyd(a.R,b,new IR,10,a.ma,C(a.C,28));else if(a.J){var c=a.R,d=new IR,e=a.J.ye();d.F=e;(e=a.J.Ne())?d.C=e.clone():d.C=null;Dyd(c,b,d,10,a.J,a.J.Il)}}
function KSf(a,b,c,d,e,f,h,k){vW.call(this,a,k);this.J=IV(a);this.L=b;this.ib=c;this.mb=d;this.R=e;this.Pa=f;this.qb=h;this.ma=new DA("",this.oa());this.Fa(this.ma);this.xa=new DA("",this.oa());this.Fa(this.xa);this.Oa=new Cl;this.bb=null;this.Ja=!1;this.Va=[];this.Sa=[];this.Ya=[];this.Ha=this.C=this.D=this.Aa=null;this.Na=[];a=Z1e(this.qb,DI(b));this.F=zz(wz(vz(new uz,10),a))}t(KSf,vW);m=KSf.prototype;m.aC=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.bb=a,LSf(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.aC(a)}))};
m.RC=function(){var a=this;if(!this.isDisposed())if(z(y(),"fecpmr"))if(ritz_api.ChartsApi){var b=r1e(this.createChartModel(),C(this.J,28));Xx(this.Ka(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.RC()});else MSf(this,function(c){c&&(c=s1e(a.L,c),Xx(a.Ka(),c))},!1)};m.qI=ea(!0);m.xD=ea("autovisFeedback");m.eH=ea(2208);m.dH=ea(2207);m.Gca=ea("Was this chart useful?");
m.Ba=function(){vW.prototype.Ba.call(this);wW(this).appendChild(Uy(tSf));b3e(this).appendChild(Uy(uSf));if(Sg(this.J,22)){this.C=new BSf(this.J,this.L,this.V,this.mb,this.R,this.Pa,this.Na,this.oa());this.Fa(this.C,!0);var a=this.C,b=this.Ld();a.Aa=b;HSf(a)}};
m.Ga=function(){vW.prototype.Ga.call(this);ky(this.Ka(),"waffle-assistant-card-draggable");var a=this.Ea("waffle-assistant-insert-chart-button");this.ma.Ua(a);sW(a,"Insert chart");a=this.Ea("waffle-assistant-zoom-button");this.xa.Ua(a);sW(a,"View full size");a=this.Ea("waffle-assistant-before-chart-preview");var b=this.Ea("waffle-assistant-after-chart-preview");this.getHandler().listen(this.Ka(),"keydown",this.IWb).listen(a,"focus",this.Nqb).listen(b,"focus",this.Ipb).listen(this.ma,"action",this.Nzb).listen(this.ma.Ka(),
"mousedown",this.Axa).listen(this.xa,"action",this.SMb).listen(this.xa.Ka(),"mousedown",this.Axa).listen(this.Ea("waffle-assistant-chart-highlights"),"mousedown",this.Axa).listen(RG(this.L),"fc",this.JWb);NSf(this);this.R.C(2790,this.F);this.C&&this.R.C(2791,this.F)};m.Ow=function(a){vW.prototype.Ow.call(this,a);NSf(this);this.pb()&&OSf(this)};function NSf(a){if(a.pb()){var b=a.Ld();a.ma.setVisible(!b);a=a.oa().Ea("waffle-assistant-button-separator",b3e(a));P(a,!b)}}
m.IWb=function(a){13==a.keyCode&&a.target==this.Ka()&&(a.preventDefault(),a.stopPropagation(),PSf(this,2255))};
function QSf(a){var b=a.ye(),c=!!C(a.J,14),d=C(a.J,16),e=!!C(a.J,15),f="Histogram"==b;b="PieChart"==b;var h=po(Xg(a.H,4));if(!h[0]||h[0].C==DI(a.L)){for(var k=1<h.length,l=[],n=0;n<h.length;n++){var q=h[n].rect;q=c!=b?GBa(q,new Xm(q.width,1)):GBa(q,new Xm(1,q.height));pd(l,q)}c=UJ(a.ib).F;var r=[];for(w in pBa)r.push(Lyc(c,pBa[w]));var w=Yc(l,function(x){return Yc(r,Ia(nn,x))});f&&e&&(w=qd(w,1));a.Ya=RSf(w.length,b&&0<d||!f&&!b&&e,b&&k);d=UJ(a.ib);for(e=0;e<w.length;e++)for(f=a.Ya[e],b=0;b<w[e].length;b++)w[e][b]&&
Hn(w[e][b])&&(k=eXe(d,w[e][b],"waffle-assistant-styled-rect"),a.qa(k),iP(d.V,"default",k,!0),Rw(k.Ka(),"background-color",f),k.setVisible(!0),a.Va.push(k),k=lP(d,w[e][b],"waffle-assistant-styled-border",1,0),a.qa(k),UAc(k,f),k.setVisible(!0),a.Sa.push(k))}}function SSf(a){Rf(a.Va);Rf(a.Sa);a.Va=[];a.Sa=[];a.Ya=[]}m.JWb=function(){this.Ja&&(SSf(this),QSf(this))};m.kS=function(){vW.prototype.kS.call(this);this.Ha=Ka();this.Ja||(QSf(this),this.Ja=!0)};
m.zM=function(){vW.prototype.zM.call(this);"number"===typeof this.Ha&&500<Ka()-this.Ha&&this.R.C(2789,this.F);this.Ha=null;SSf(this);this.Ja=!1};m.Nqb=function(){var a=this.Ea("waffle-assistant-chart-highlights");hx(a)?a.focus():this.Ka().nextSibling&&this.Ka().nextSibling.focus()};m.Ipb=function(){this.O&&U2e(this.O)||this.xa.Ka().focus()};m.Nzb=function(){PSf(this,2255)};m.Axa=function(a){a.stopPropagation()};m.SMb=function(){ntb.kb(this,this.F)};m.hPa=function(a,b){PSf(this,2257,a,b)};
function PSf(a,b,c,d){if(z(y(),"fecpmr")){var e=a.createChartModel();KI(a.L).dispatchEvent(new u4e(e,C(a.J,28),a.V,b,c,d,Gk(a.F),C(a.J,29),a.Na))}else MSf(a,function(f){f&&(f=new v4e(f,a.V,a.D&&a.D.Ne(),b,c,d,Gk(a.F),C(a.J,29),a.Na),KI(a.L).dispatchEvent(f))},!1)}function TSf(a,b){P6e(b,USf(a),a.mb,a.R,function(){null!==a.Aa&&(cl($k(),a.Aa),a.Aa=null);a.isDisposed()||(a.bb(),OSf(a))})}function OSf(a){if(!a.Ld()){var b=USf(a);if(!a.Pa.contains(b)){var c=a.Pa;a=new xSf(b,a);b4c(c,a)}}}
function VSf(a,b,c){var d=[];try{var e=a.Oa.ob(c),f=El(e,ng),h=ritz_api.RitzModelApi.getVerbalHighlightsForProto(f,ritz.charts.model.ChartTypes.toGviz(b.getTypeOrdinal()),0!=b.getStackingTypeOrdinal(),b.getTitle(),hX(b,ritz.charts.model.AxisNames.X),hX(b,ritz.charts.model.AxisNames.Y),hX(b,ritz.charts.model.AxisNames.RIGHT),b.getDomainDataBacked());d=Yc(h,z9e)}catch(k){d=[]}a=a.Ea("waffle-assistant-chart-highlights");P(a,0<d.length);0<d.length&&(a.appendChild(d[0]),Hp(a,!0))}
m.createChartModel=function(){WSf(this);var a=ritz.charts.model.ChartImpl.create(),b=C(this.J,28);ritz_api.ChartsApi.setChartModel(a,El(this.Oa.ob(b.Qk()),eg));b=El(this.Oa.ob(b),ng);a.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(b));return a};function XSf(a){WSf(a);C(a.J,16);var b=V3e(a.J);b.eBa(vpc);var c=F3e(a.H);b.Xo(c.toString());a.C&&(c=c.clone(),a.C.L=c);return b}function WSf(a){a.$d&&(a.Aa=bl($k(),"aaoar"),a.$d=!1)}
function LSf(a){if(z(y(),"fecpmr")){var b=a.createChartModel(),c=b.copy();R6e(c);VSf(a,b,C(a.J,28));TSf(a,c);a.C&&ESf(a.C,b)}else{var d=W3e(XSf(a),a.Ea("waffle-assistant-card-inner"));(new QV(vpc,d.Il)).send(function(e){if(e)if(e.Dk())WL.NJ(USf(a),e);else{d.Kj(e.Ne());LW(d,d.Ne());e=new Ss;e.setContext(d.toJSON());var f=!!C(a.J,14);D(e,3,f);var h=C(a.J,16);D(e,4,h);D(e,5,f);D(e,8,0);C(a.J,24)&&(f=C(a.J,25),D(e,9,f));f=po(Xg(a.H,4));for(h=0;h<f.length;h++)e.addRange(mo(f[h].rect,f[h].C));f=(f=d.Ne())?
f.toJSON():null;h=ritz.charts.model.GvizChart.create();h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);VSf(a,h,e);a.D=d;e=(e=d.Ne())?e.toJSON():null;f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);TSf(a,f)}});a.C&&MSf(a,function(e){var f=a.C,h=d;e=new cM(e.toJSON());h=new cM(h.toJSON());var k=f.Qf("waffle-assistant-faceted-chart");if(1<k.length){JSf(e);var l=h;ISf(l);l.setOption("pieSliceText","percentage");
l.setOption("axisFontSize",0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=e,JSf(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),ISf(h);l=po(Xg(f.C,27));wpc(f.L,l);l=C(f.C,25);for(var n=0;n<k.length;n++){var q="string"===
typeof f.H[n]?f.H[n]:null,r=l.clone(),w=f.O,x=new Ys;D(x,1,w);"string"===typeof q&&x.setValue(q);D(r,7,x);f.L.Jb("dt",encodeURIComponent(JSON.stringify(f.Na.ob(r))));r=new cM(e.toJSON());r.Xo(f.L.toString());w=h.clone();w.Xo(f.L.toString());x=f;var F=r.getOption("title");F||(F=o1e(r));x=FSf(x,F,q);r.setOption("title",x);w.setOption("title",x);x=new ASf(r,w,f.Ja,f.Pa,f.R,f.oa());f.Fa(x);F=k[n];x.Ua(F);f.V.push(x);GSf(f,F,o1e(r),q);f.J=w}HSf(f);f.Ka().style.visibility="visible"},!1)}}
function MSf(a,b,c){var d=XSf(a);(new QV(vpc,d.Il)).send(function(e){e?(e=e.Ne(),c&&d.Kj(e),LW(d,e),b(d)):b(null)})}m.ye=function(){return this.J.ye()};function RSf(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=T3e("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&pd(d,d);return d}function USf(a){return a.Ea("waffle-assistant-chart-preview")}
function YSf(a,b){a=a.title;var c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="',d=" "+(T(a)+" Section ");c+=Hx(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+R(a)+"</div>";c+=R(CA({Yc:"waffle-assistant-section-more-button",content:Fx("More"),style:4},b));return S(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')}
function n_(a,b,c,d){Q.call(this,d);this.V=a;this.Ya=b;this.xa=new DA("",this.oa());this.Fa(this.xa);this.L=new Q(this.oa());this.Fa(this.L);this.C=null;this.Na=[];this.ma=this.Ja=!1;this.R=c}t(n_,Q);m=n_.prototype;m.XRa=ea(!1);m.PBa=ea(!0);m.Ba=function(){Q.prototype.Ba.call(this);this.jb(Uy(YSf,{title:this.getTitle()}))};
m.Ga=function(){Q.prototype.Ga.call(this);this.L.Ua(this.Ea("waffle-assistant-section-card-holder"));this.xa.Ua(this.Ea("waffle-assistant-section-more-button"));this.getHandler().listen(this.xa,"action",this.YBb);this.C=this.WHa();this.qa(this.C);P(ZSf(this),this.XRa());this.setVisible(!1)};m.setVisible=function(a){this.pb()&&this.isVisible()!=a&&(P(this.Ka(),a),a&&(P(this.xa.Ka(),this.w2a()),a=new pk,a=L(a,4,this.E6()),a=qk(new mk,a),a=zz(wz(vz(new uz,10),a)),this.R.C(2774,a)))};
m.isVisible=function(){return this.pb()&&hx(this.Ka())};m.w2a=function(){return this.Na.length>this.V};m.WHa=function(){return new UW(this.oa())};m.nS=function(a){this.ma=a;Vc($Sf(this),function(b){b.Ow(a)});L7e(this.C,a)};m.Ld=g("ma");m.fWa=ba();
m.lS=function(a){this.Na=a;for(var b=0;b<a.length;b++){if(this.L.Zb()<this.V){var c=this.uV(a[b]);c.Ow(this.ma);var d=this.L.Zb();c.V=d;this.L.Fa(c,!0)}if(this.PBa()&&(this.C.kJ(!1),c=this.uV(a[b]),c.Ow(this.ma),d=this.C,d.C.push(c),d.ld)){J7e(d,!1);var e=d.O.Zb();c.V=e;d.O.Fa(c,!0);c.HP()}}};function $Sf(a){var b=[];a.L.Se(function(c){b.push(c)});return b}function ZSf(a){return a.Ea("waffle-assistant-section-content")}m.Aua=function(){return this.L.R4()};
m.mS=function(){this.Na=[];Rf(this.L.jd(!0));this.setVisible(!1);this.PBa()&&(this.C.u1(),this.C.kJ(!0))};function aTf(a){a.L.Se(function(b,c){c<this.V&&b.HP()},a)}m.G6=function(a){var b=0;if(this.Ja)this.C.gWa();else if(this.Aua()){this.setVisible(!0);b=ex(this.Ea("waffle-assistant-section-header")).height+ex(ZSf(this)).height;for(var c=$Sf(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.vOa(c[d]),d3e(c[d],!0),b+=ex(c[d].Ka()).height):d3e(c[d],!1)}else this.setVisible(!1);return a-b};m.vOa=ba();
m.setActive=function(a){(this.Ja=a)||this.C.xaa()};m.Cb=g("Ja");m.Rn=function(a){this.C&&J7e(this.C,a)};function bTf(a,b){a.C.Uia(b,a.getTitle())}m.YBb=function(){this.setActive(!0);this.dispatchEvent("ee")};function cTf(){return S('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')}function dTf(a,b){vW.call(this,a,b);this.C=IV(a)}t(dTf,vW);m=dTf.prototype;m.RC=ba();m.xD=ea("assistantWordCloudFeedback");
m.eH=ea(2634);m.dH=ea(2633);m.Ba=function(){vW.prototype.Ba.call(this);wW(this).appendChild(Uy(cTf));ky(wW(this),"waffle-assistant-word-cloud-content-container")};m.aC=function(a){for(var b=Xg(this.C,19),c=Xg(this.C,20),d=this.Ea("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(eTf(this,b,c,e),120<d.clientHeight){eTf(this,b,c,e-1);break}b=this.oa();c=C(this.C,2);c=Qp(b,c);d=this.Ea("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function eTf(a,b,c,d){var e=a.Ea("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Qp(a," "));var l=a.createElement("SPAN");a.appendChild(l,Qp(a,b[k]));a.appendChild(e,l);ky(l,"waffle-assistant-word-cloud-word");var n=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(n-f)/(h-f)*15+9+"px"}}
function fTf(a,b,c,d,e,f){var h=Pc(y(),"fmnac");h||(h=20);n_.call(this,h,e,d,f);this.Aa=a;this.H=b;this.Ca=c;this.D=new ySf;this.qa(this.D);this.F=null;this.O=0;this.J=null}t(fTf,n_);m=fTf.prototype;m.Ga=function(){n_.prototype.Ga.call(this);this.D.init();this.getHandler().listen(this.D,"drag",this.HWb).listen(this.D,"dragend",this.Im)};m.getTitle=ea("Analysis");m.f1=function(a){return 0==a};
m.uV=function(a){return"WordCloud"==IV(a).ye()?new dTf(a,this.oa()):new KSf(a,this.Aa,this.H,this.Ca,this.R,this.D,this.J,this.oa())};m.nS=function(a){n_.prototype.nS.call(this,a);a&&d2c(this.D)};m.vOa=function(a){this.getHandler().Kc(a,"content-rendered",this.GWb);this.O++};m.lS=function(a,b){this.J=b||null;n_.prototype.lS.call(this,a,b);var c=a.map(function(d){return IV(d).ye()});Vc($Sf(this),function(d){d instanceof KSf&&(d.Na=c)})};m.GWb=function(){0==--this.O&&this.dispatchEvent("ae")};
m.HWb=function(){this.F=ax(this.D.Nc.target)};m.Im=function(a){var b=this.F,c=UJ(this.H).D;if(an(bO(c,"page",!1,!1)).contains(b)){var d=$N(c,b.x,b.y,"page");c=cO(c,d,"page");b=new Qm(b.x-c.left,b.y-c.top);a.C.getData().hPa(d,b)}this.F=null};m.E6=ea(2);
function gTf(a,b){a=S;var c='<div class="'+T("waffle-assistant-answers-logging-message-container")+'"><div class="'+T("waffle-assistant-answers-logging-message")+'"><span class="'+T("waffle-assistant-answers-logging-text")+'">';c=c+"We're logging your queries and data to improve the feature.</span><div class=\""+(T("waffle-assistant-answers-learn-more")+'">');c=c+'Learn More</div><div class="'+(T("waffle-assistant-answers-logging-opt-out")+'">');c=S(c+"Opt-out for this file</div></div></div>");return a(c+
'<div class="'+T("waffle-assistant-answers-input")+" "+T("waffle-assistant-answers-input-with-icon")+'"><form class="'+T("waffle-assistant-answers-query-box")+'">'+R(h7e(b))+"</form></div>")}
function hTf(a,b,c,d,e,f,h,k,l,n){n_.call(this,1,f,e,n);this.Va=c;this.bb=b;this.Ha=null;this.Ca=new Dz("",new zR,this.oa());this.Fa(this.Ca);this.Pa=new Dz("",new zR,this.oa());this.Fa(this.Pa);f=new tO(a,!0,!0);f=new m4e(f);this.Aa=new g3e(e);this.O=new I8e(this.Va,f,e);this.H=new M8e(this.O,a,b,c,d,e,this.Ya,f,this.Aa,h,k,l,this.oa());this.D=new FW(b,"waffle-assistant-answers-styled-border","waffle-assistant-answers-styled-rect");this.qa(this.D);this.F=this.J=null;this.Sa=zz(vz(new uz,10));this.Oa=
!1}t(hTf,n_);m=hTf.prototype;m.Ba=function(){n_.prototype.Ba.call(this);var a=Uy(gTf);this.oa().appendChild(ZSf(this),a)};
m.Ga=function(){n_.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-answers-query-box"),b=this.Ea("waffle-assistant-answers-input-box");this.Pa.Ua(this.Ea("waffle-assistant-answers-logging-opt-out"));this.Ca.Ua(this.Ea("waffle-assistant-answers-learn-more"));this.getHandler().listen(a,"focus",this.OFb,!0).listen(a,"blur",this.MFb,!0).listen(a,"mouseover",this.QFb).listen(a,"mouseout",this.PFb).listen(a,"click",this.NFb).listen(b,"input",this.RWb).listen(this.Pa,"action",this.UDb).listen(this.Ca,
"action",this.uAb).listen(RG(this.Va),"fc",MXe(this.SWb,25,this));this.setVisible(null!=this.J);iTf(this,mqb&&nqb&&SC("showAnswersLoggingOptOut"))};m.w2a=ea(!1);m.XRa=ea(!0);m.PBa=ea(!1);m.getTitle=ea("Answers");m.E6=ea(1);m.f1=function(a){return 3==a||0==a||1==a};
m.lS=function(a,b){ud(a,function(l,n){return C(n,2)-C(l,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Yg(a[f],1);3==h?e=a[f]:0==h?c.push(IV(a[f])):1==h&&d.push(a[f])}if(e&&C(e,2)){f=b||null;h=Sg(e,11)?C(e,11):null;var k=null==h?null:no(C(e,10));0<Tg(e,4)?jTf(this,no(HV(e)),C(e,9),k,h,c,d):jTf(this,f,C(e,9),k,h,c,d);this.F||(n_.prototype.lS.call(this,a,b),this.getHandler().listen(this.F,"sqc",this.eKb))}else this.mS(!0)};
m.uV=function(a){if(!this.F){var b=q8e(this.O,3);this.F=new G8e(a,this.bb,this.R,this.Aa,b,C8e,"regular",void 0,this.oa())}return this.F};m.WHa=g("H");m.Aua=function(){return this.isVisible()};m.mS=function(a,b,c){this.O.reset();(a||b)&&this.F&&(n_.prototype.mS.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||void 0!==b&&!b)this.F&&(n_.prototype.mS.call(this,a,b,c),this.F.dispose(),this.F=null),this.pb()&&(this.O.reset(),this.J=null,S8e(this.H),this.setVisible(!1),this.Cb()&&GW(this.D));c&&this.H.reset()};
m.Rn=function(a,b){b||J7e(this.H,a)};m.fWa=function(a){this.Ha=a;var b=this.H;b.Na=a;b.xa.qE(a);b.Ca.qE(a);this.O.L=a;this.Aa.C=a};m.setActive=function(a){n_.prototype.setActive.call(this,a);a?HW(this.D,this.J):GW(this.D)};function kTf(a,b){a.Cb()&&(b?GW(a.D):HW(a.D,a.J))}function iTf(a,b){P(a.Ea("waffle-assistant-answers-logging-message-container"),b)}function lTf(a,b){a=a.Ea("waffle-assistant-answers-query-box");oy(a,"waffle-assistant-answers-query-box-focused",b)}
m.SWb=function(){this.Cb()&&HW(this.D,this.J)};m.OFb=function(){lTf(this,!0);HW(this.D,this.J)};m.MFb=function(){lTf(this,!1);this.Cb()||GW(this.D)};m.QFb=function(){HW(this.D,this.J)};m.PFb=function(){this.Cb()||GW(this.D)};m.NFb=function(){mTf(this,"")};m.RWb=function(){var a=this.Ea("waffle-assistant-answers-input-box");Ze(a.value)||(mTf(this,a.value),a.value="")};m.eKb=function(a){mTf(this,a.C,!1,!0,a);this.R.C(2652,this.Sa)};
function mTf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;a.setActive(!0);a.dispatchEvent("ee");nTf(a,b,c);if(d&&b){var f=new US;e instanceof A8e?f=d2e(1,e.F,e.D,1):e instanceof n7e&&(f=e9e(e));c=new Mq(function(){R8e(a.H,b,f,e)},300);a.qa(c);c.start()}}function nTf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;var f=new Mq(function(){var h=a.H;h.D&&x7e(h.D,b,!0);h=a.H;var k=c||!1;h.We=k;h.$c.R=k;h.wc.R=k;d&&b&&(h=new US,e&&(h=e9e(e)),R8e(a.H,b,h,e))},300);a.qa(f);f.start()}
function jTf(a,b,c,d,e,f,h){c=c||new CJ;a.J=b;a.O.init(c,b,d,e,f,h);a.O.XY();a.O.YY().then(function(k){var l=a.Za("waffle-assistant-answers-input-box");l&&0<k.length&&z(y(),"feaipu")&&l.setAttribute("placeholder","Try '"+(k[0].query+"'"))},null,a);a.setVisible(null!=b);P8e(a.H,b,c,d,e,a.Oa,f);a.Oa=!1;a.Cb()&&HW(a.D,a.J)}m.UDb=function(a){a.stopPropagation();a.preventDefault();this.Ha&&(gr(Pl(Ql(this.Ha.Re("/answers/logoptout"),u(this.XAb,this)),u(this.WAb,this)),"POST").Me(),this.R.C(2663,this.Sa))};
m.uAb=function(a){a.stopPropagation();a.preventDefault();wx("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};m.XAb=function(a){a.Pj()&&iTf(this,!1)};m.WAb=ba();
function oTf(a,b){a=S;b=""+R(CA({Yc:"waffle-assistant-datavalidation-apply-button",content:"Apply",style:4},b));b=S(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function pTf(a){return S('<div class="waffle-assistant-datavalidation-detail-chip">'+R(a.Zdb)+"</div>")}
function qTf(a,b,c,d){vW.call(this,a,d);this.D=new FW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.D);this.C=new DA("",this.oa());this.Fa(this.C);this.F=HV(a);this.L=c}t(qTf,vW);m=qTf.prototype;m.Ba=function(){vW.prototype.Ba.call(this);wW(this).appendChild(Uy(oTf))};
m.Ga=function(){vW.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-datavalidation-apply-button");this.C.Ua(a);sW(a,"Apply data validation");this.getHandler().listen(this.C,"action",this.gqb).listen(this.Ka(),"mouseenter",this.lXb).listen(this.Ka(),"mouseleave",this.mXb);a=tTe(new pk,P9e(Dh(C(C(this.H,13),3))));a=qk(new mk,a);a=zz(wz(vz(new uz,10),a));this.L.C(35577,a)};
m.aC=function(a){var b=yM(oo(this.F)),c=C(C(this.H,13),3);switch(Dh(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Eh(c).map(function(k){return C(k.sp().getValue(),2)});break;case 1:d="Numeric validation";c=["Greater than "+C(Eh(c)[0].sp().getValue(),3)];break;case 7:d="Numeric validation";c=Eh(c);c=["Between "+(C(c[0].sp().getValue(),3)+(" and "+C(c[1].sp().getValue(),
3)))];break;case 5:d="Numeric validation";c=Eh(c);c=["Equal to "+C(c[0].sp().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new OC,f=e.text(d)+(" for "+(e.Wc("SPAN".toString(),{hG:"waffle-assistant-datavalidation-range"})+e.text(b)+e.Uc("SPAN".toString())));sga(this.Ea("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Ea("waffle-assistant-datavalidation-details");Vc(c,function(k){k=Uy(pTf,{Zdb:k});h.appendChild(k)});b="Suggested data validation: "+(d+(" "+(c.join()+
(" for "+b))));Xx(this.Ka(),b);a()};m.RC=ba();m.xD=ea("assistantDataValidationFeedback");m.eH=ea(35551);m.dH=ea(35550);m.gqb=function(){this.dispatchEvent(new uW("Yd",this,35549))};m.lXb=function(){HW(this.D,no(this.F))};m.mXb=function(){GW(this.D)};function rTf(a,b,c,d){n_.call(this,1,b,a,d);this.D=c}t(rTf,n_);m=rTf.prototype;m.getTitle=ea("Data Validation");m.f1=function(a){return 6==a};
m.uV=function(a){var b=C(a,1);switch(b){case 6:return new qTf(a,this.D,this.R,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.nS=function(a){n_.prototype.nS.call(this,a);this.setVisible(!a)};m.G6=function(a){return this.Ld()?(this.setVisible(!1),a):n_.prototype.G6.call(this,a)};m.E6=ea(4);function sTf(a,b,c){uW.call(this,"Wd",a,b);this.D=c}t(sTf,uW);function tTf(a){a=""+R(CA({Yc:"waffle-assistant-formatting-edit-button",content:"Edit",style:4},a));return S(a)}
function uTf(a,b){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+(tTf(b)+"</div>");return S(a)}
function vTf(a,b){return S('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+tTf(b)+"</div>")}function wTf(a,b,c){uW.call(this,"de",a,b);this.D=c}t(wTf,uW);function xTf(a,b,c,d){vW.call(this,a,d);a=Yc(Xg(this.H,7),T9e);this.C=new Y9e(!1,a,7);this.Fa(this.C);this.L=new DA("",this.oa());this.Fa(this.L);this.ma=b;this.F=!1;this.D=-1;this.R=c}
t(xTf,vW);m=xTf.prototype;m.Ba=function(){vW.prototype.Ba.call(this);wW(this).appendChild(Uy(uTf))};m.Ga=function(){vW.prototype.Ga.call(this);this.getHandler().listen(this.L,"action",this.ewb).listen(this.C,"Xe",this.Iqb);this.ma.C(2768)};
m.aC=function(a){var b=this.Ea("waffle-assistant-banding-color-picker-container");this.C.render(b);Z9e(this.C);b=this.Ea("waffle-assistant-banding-range");var c=HV(this.H),d=oo(c);Gp(b,yM(d));yTf(this,c);b=this.Ea("waffle-assistant-formatting-edit-button");this.L.Ua(b);a()};m.RC=function(){Xx(this.Ka(),"Suggested alternating background colors");this.C.xe("Choose a color scheme")};m.xD=ea("assistantBandingFeedback");m.eH=ea(2672);m.dH=ea(2671);
m.ewb=function(a){MJ.dispatchEvent({type:"show-banding-pane-recommendation",U_a:this.H,vdb:a$e(this.C)});a.stopPropagation()};m.Iqb=function(a){var b=this;if(!this.F&&$9e(this.C)){var c=this.D;this.D=this.C.Ni();this.D==c?this.dispatchEvent(new wTf(this,2797,function(){b.R.clear()})):this.dispatchEvent(new sTf(this,2673,function(){K4e(b.R,"Alternating colors applied",b.oa(),function(){b.dispatchEvent(new uW("ie",b,2796))})}));a.stopPropagation()}};
function yTf(a,b){a.F=!0;var c=b.hb();b=oo(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.Lb(),b.Kb(),b.Oc(),b.Qc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=Dl(c,cia),c=(new Cl).Hd(ft.getDescriptor(),c),c=T9e(c)):c=null;c?(c=b$e(a.C,c),jM(a.C,c?c.getElement():null)):jM(a.C,null);a.D=a.C.Ni();a.F=!1}function zTf(a,b){iz.call(this,void 0,void 0,b);this.C=a}t(zTf,iz);
zTf.prototype.Bc=function(a){iz.prototype.Bc.call(this,a);var b=this.C.Kd;switch(b.length){case 0:break;case 1:var c="one-rule";break;case 2:case 4:c="two-rules";break;default:c="three-rules"}for(var d=0;d<b.length;d++){var e=b[d],f=kp("DIV");ly(f,["waffle-assistant-conditionalformat-format-preview",c]);var h=kp("DIV");ky(h,"waffle-assistant-conditionalformat-format-preview-label");f.appendChild(h);Gp(h,"123");if(Sg(e,2)){var k=C(C(e,2),1);switch(Dh(Gh(k))){case 9:case 13:k=Eh(Gh(k))[0];var l=Xg(e,
1)[0];Gp(h,dH(k,Yg(l,1),Yg(l,2),Yg(l,4)))}}n$e(e,f);a.appendChild(f)}};zTf.prototype.Ng=function(){var a=this.C;a.dispatchEvent(new uW("Xd",a,2563));return!0};function ATf(a,b){vW.call(this,a,b);this.C=new DA("",this.oa());this.Fa(this.C);this.Kd=Xg(a,6)}t(ATf,vW);m=ATf.prototype;m.Ba=function(){vW.prototype.Ba.call(this);wW(this).appendChild(Uy(vTf))};
m.Ga=function(){vW.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-formatting-edit-button");this.C.Ua(a);sW(a,"Apply and edit conditional format rules");this.getHandler().listen(this.C,"action",this.eqb)};m.aC=function(a){Gp(this.Ea("waffle-assistant-conditionalformat-description"),Yg(this.H,3));var b=this.Ea("waffle-assistant-conditionalformat-rule-holder"),c=new zTf(this,this.oa());this.Fa(c);c.Ua(b);sW(b,"Apply conditional format rules");a()};m.RC=ba();m.xD=ea("assistantConditionalFormatFeedback");
m.eH=ea(2630);m.dH=ea(2629);m.eqb=function(){this.dispatchEvent(new uW("Xd",this,2563));this.dispatchEvent(new uW("$d",this,2670,void 0,void 0,oo(C(this.Kd[0],1,0))));l6b()};function BTf(a,b,c){n_.call(this,2,b,a,c)}t(BTf,n_);m=BTf.prototype;m.getTitle=ea("Formatting");m.f1=function(a){return z(y(),"feecfr")&&2==a||4==a};
m.uV=function(a){var b=C(a,1);switch(b){case 2:return new ATf(a,this.oa());case 4:return new xTf(a,this.R,this.Ya,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.nS=function(a){n_.prototype.nS.call(this,a);this.setVisible(!a)};m.G6=function(a){return this.Ld()?(this.setVisible(!1),a):n_.prototype.G6.call(this,a)};m.E6=ea(3);function o_(a,b,c,d,e){Q.call(this);this.R=a;this.Sa=b;this.C=c;this.L=d;this.D=e}t(o_,Q);
o_.prototype.Zga=function(a,b,c){this.C=a;this.L=b;this.D=c};o_.prototype.Ga=function(){Q.prototype.Ga.call(this);this.getHandler().listen(this.R.C,"na",this.Va)};o_.prototype.Va=function(){this.Sa.kb()};function CTf(a,b,c,d){d=void 0===d?!1:d;uW.call(this,"fe",null,2859);this.D=a;this.O=b;this.F=c;this.L=!!d}t(CTf,uW);
function DTf(a,b){A.call(this);this.F=a;this.H=b;this.C=new FW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.qa(this.C);this.D=new FW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.qa(this.D)}t(DTf,A);DTf.prototype.Ia=function(){GW(this.C);GW(this.D);A.prototype.Ia.call(this)};
function ETf(a,b,c,d,e,f){pAc(b);var h=LG(d);h=new jn(h.Lb(),h.Kb(),Math.min(h.Oc(),h.Lb()+6),Math.min(h.Qc(),h.Kb()+6));var k=kO(b),l=UJ(a.F).D,n=aN(l,new cn(h.Lb(),h.Oc()),"r",!0,!1,!0,!0)-1,q=aN(l,new cn(h.Kb(),h.Qc()),"c",!0,!1,!0,!0)-1;l.Ib()&&--q;n=Math.min(200,n);q=Math.min(c.offsetWidth-2,q);qAc(b,k,q,n);c=hSf(d,e,f);a.H.render(b,h,c);b=a.C;h=d.Lb();k=d.Kb();switch(e){case 0:h=Math.min(d.Oc(),d.Lb()+f);break;case 1:k=Math.min(d.Qc(),d.Kb()+f)}d=dTb(d.hb(),h,k,d.Oc(),d.Qc());HW(b,KG(d));HW(a.D,
KG(c))}
function FTf(a){var b=a.u_a,c=a.t_a,d=a.aZa;a=a.J$;return S('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+T(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+R(b)+'</div></div><div class="waffle-tables-popup-content">'+R(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+R(d)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+R(a)+"</div></div></div></div>")}
function GTf(){var a=S('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+FTf({u_a:"Edit data range",t_a:Fx(""+a),aZa:"Update",J$:"Cancel"});return S(a)}function HTf(){var a=""+FTf({u_a:"Improve suggestions",t_a:Fx('<div class="waffle-tables-popup-header-message"></div>'),aZa:"No",J$:"Yes"});return S(a)}function ITf(a){a='<div class="waffle-tables-bar-content">For <span class="waffle-assistant-table-bar-range">'+(R(a.GC)+"</span></div>");return S(a)}
function JTf(a){a='Is <span class="waffle-assistant-table-first-header">'+(R(a.nR)+"</span> a header row, containing titles that describe the columns below?");return S(a)}function KTf(a,b,c,d,e,f,h){o_.call(this,a,QBb,d,e,f);this.F=bC(new aC);this.qa(this.F);this.J=new Dz("",new yR,this.oa());this.Fa(this.J);yA(this.F,this.J,RBb);this.H=new Dz("",new yR,this.oa());this.Fa(this.H);yA(this.F,this.H,QBb);this.V=new DTf(b,c);this.qa(this.V);this.O=new uA(this);this.qa(this.O);this.xa=h}t(KTf,o_);
KTf.prototype.Ba=function(){this.jb(Uy(HTf))};
KTf.prototype.Ga=function(){o_.prototype.Ga.call(this);this.J.Ua(this.Ea("waffle-tables-popup-done"));this.H.Ua(this.Ea("waffle-tables-popup-cancel"));var a=hSf(this.C,this.D,1);a=yM(LG(a));a=Uy(JTf,{nR:a});this.Ea("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(RBb,"action",this.Aa).subscribe(QBb,"action",this.ma);a=this.Ea("waffle-assistant-table-canvas");var b=this.Ea("waffle-assistant-canvas-container");ETf(this.V,a,b,this.C,this.D,this.L);a=this.Ea("waffle-tables-popup");
oy(a,"waffle-tables-popup-answers-enabled",this.xa);b=new XB(a,this.oa());this.qa(b);YB(b);a.focus()};KTf.prototype.ma=function(){this.dispatchEvent("ge")};KTf.prototype.Aa=function(){var a=LG(this.C);switch(this.D){case 0:a=In(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=In(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.L-1,c=this.C.hb();this.dispatchEvent(new CTf(new Jn(c,a),b,this.D));this.dispatchEvent("ge")};
function LTf(a,b,c,d,e,f,h,k,l,n,q){vW.call(this,l,q);this.Va=b;this.Ya=c;this.Na=d;this.bb=n;this.Ha=e;this.Pa=h;this.L=new Dz("",new yR,this.oa());this.Fa(this.L);this.ma=new Dz("",new yR,this.oa());this.Fa(this.ma);this.C=this.R=this.F=null;this.Sa=this.Ya.L.C;this.Aa=zz(vz(new uz,66));this.Ja=f;this.xa=new FW(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.xa);this.Oa=Xg(l,4);this.D=null}t(LTf,vW);m=LTf.prototype;m.qI=ea(!0);
m.Ba=function(){vW.prototype.Ba.call(this);wW(this).appendChild(Uy(iSf));b3e(this).appendChild(Uy(jSf))};
m.Ga=function(){var a=this;vW.prototype.Ga.call(this);var b=C(this.H,5);b=q4e(this.Pa,b);this.R=new y4e(b,this.Sa,this.bb);b=this.Ea("waffle-assistant-insert-pivottable-button");this.L.Ua(b);sW(b,"Insert Pivot Table");b=this.Ea("waffle-assistant-zoom-button");this.ma.Ua(b);sW(b,"Preview Pivot Table");this.getHandler().listen(this.L,"action",function(){MTf(a,35619)}).listen(this.ma,"action",this.kWa);this.Ow(this.Ld())};
m.aC=function(a){var b=this.oa();b.ze(this.Ea("waffle-assistant-answercard-interpret"),Yg(this.H,3));this.C=b.Ba("CANVAS","waffle-pivottable-pivot-canvas");b.Qi(this.C,!0);Xx(this.C,"Pivot table canvas");var c=this.Ea("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=C(this.H,5);this.D=new x4e(c,this.Ja,this.Va,this.Na);this.D.H=b;c=this.Ld();this.D.F=c;this.getHandler().Lf(this.C,Po,this.kWa).listen(this.C,"mousedown",this.jWa).Kc(this.D,"pivot_inserted",this.nXb);z4e(this.R,
this.C);a()};m.nXb=ba();m.Ow=function(a){vW.prototype.Ow.call(this,a);if(this.L&&this.pb()){this.L.setVisible(!a);var b=this.oa().Ea("waffle-assistant-button-separator",b3e(this));P(b,!a)}this.F&&C4e(this.F,this.Ld());this.D&&(a=this.Ld(),this.D.F=a)};m.RC=function(){Xx(this.Ka(),"Suggested Pivot Table-"+Yg(this.H,3))};m.xD=ea("assistantPivotTableFeedback");m.eH=ea(2632);m.dH=ea(2631);
function MTf(a,b){Sg(a.H,5)&&z(y(),"fewt")&&Dpa(C(a.H,5),1);var c=new F4e(null,C(a.H,5),function(){a.dispatchEvent("close-sidebar");a.Ha.C(b,a.Aa)});MJ.dispatchEvent(c)}m.kWa=function(){var a=this;this.Ha.C(35620,this.Aa);this.F=new B4e(this.R,Yg(this.H,3),function(){MTf(a,35621)},function(){a.jWa()},this.oa());this.F.render();this.qa(this.F);C4e(this.F,this.Ld())};m.jWa=function(){this.C&&this.C.focus()};m.kS=function(){vW.prototype.kS.call(this);E4e(this.xa,po(this.Oa))};
m.zM=function(){vW.prototype.zM.call(this);GW(this.xa)};function NTf(a,b,c,d,e,f,h,k,l){n_.call(this,1,f,e,l);this.H=d;this.Aa=b;this.Ca=c;this.F=h;this.Ha=k;this.J=zz(vz(new uz,10));a=new tO(a,!0,!0);this.O=new m4e(a);this.D=null}t(NTf,n_);m=NTf.prototype;m.getTitle=ea("Pivot Table");m.f1=function(a){return 1==a};
m.uV=function(a){var b=C(a,1);switch(b){case 1:return new LTf(this.D,this.Aa,this.Ca,this.H,this.R,this.F,this.O,this.J,a,this.Ha,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.lS=function(a,b){C(a[0],5)&&(this.D=b?b:null,n_.prototype.lS.call(this,a,b))};m.E6=ea(5);function OTf(){var a=null,b=new tq(function(){null!==a&&gq(a)});a=fq(function(){b.callback()});return b}function PTf(a,b,c){Vo.call(this);this.C=urc(OM.getInstance(),a,b,c);this.D=xq()}t(PTf,Vo);
PTf.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!bd(c,function(f){return CBa(f,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].xi()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&IWe(this.C),this.D=OTf(),this.D.addCallback(function(){return hXe(d.C,b,!0)}))};
function QTf(a,b){a=a.B6b;var c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+R(CA({content:"INSERT CHART",style:4,Yc:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=R(CA({Yc:"waffle-autovis-lightbox-close",content:Fx(""+R(QB({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:"Close"},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+Hx("Previous chart");d+='"';c+=R(CA({content:Fx("&#10094;"),style:4,Yc:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Gx(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+Hx("Next chart");d+='"';c+=R(CA({content:Fx("&#10095;"),style:4,Yc:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Gx(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
R(a)+"</div></div></div>";return S(c)}function RTf(){return S('<div class="waffle-autovis-lightbox-chart"></div>')}function STf(a,b,c,d,e){Q.call(this,e);this.F=a;this.D=b;this.V=c;this.R=d;this.H=[];this.C=new DA("",this.oa());this.Fa(this.C);this.O=new DA("",this.oa());this.Fa(this.O);this.L=new DA("",this.oa());this.Fa(this.L);this.J=new DA("",this.oa());this.Fa(this.J)}t(STf,Q);m=STf.prototype;m.Ba=function(){Q.prototype.Ba.call(this);this.jb(Uy(QTf,{B6b:this.F.length}))};
m.Ga=function(){Q.prototype.Ga.call(this);var a=mtb.isEnabled();TTf(this,!a);a=this.Ea("waffle-autovis-lightbox-close");this.C.Ua(a);a=this.Ea("waffle-autovis-lightbox-insert");this.O.Ua(a);var b=this.Ea("waffle-autovis-lightbox-previous");this.L.Ua(b);b=this.Ea("waffle-autovis-lightbox-next");this.J.Ua(b);UTf(this);VTf(this,this.D,!1);this.getHandler().listen(document.body,"focusin",this.AXb).listen(this.Ka(),"keydown",this.BXb).listen(jp(),"resize",this.EXb).listen(this.C,"action",this.close).listen(this.O,
"action",this.Ozb).listen(this.L,"action",this.DXb).listen(this.J,"action",this.CXb);b=new XB(this.Ka(),this.oa());YB(b);this.qa(b);a.focus()};function UTf(a){var b=a.Ea("waffle-autovis-lightbox-content"),c=a.Ea("waffle-autovis-lightbox-content-inner");a=a.Ea("waffle-autovis-lightbox-page-count");var d=ip();a=ex(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;bx(c,d,e);bx(b,d,e+a.height+35)}function TTf(a,b){oy(a.Ka(),"waffle-autovis-lightbox-readonly",b)}
function VTf(a,b,c){c&&OJ("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?WTf(a,b):a.F[b]&&(z(y(),"fecpmr")?(c=a.F[b].createChartModel(),XTf(a,c,b)):MSf(a.F[b],function(d){if(!a.isDisposed()&&d){var e=d.Ne();e=e?e.toJSON():null;var f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);XTf(a,f,b)}},!0))}function XTf(a,b,c){var d=a.Ea("waffle-autovis-lightbox-container"),e=Uy(RTf);d.appendChild(e);a.H[c]=e;P6e(b,e,a.V,a.R);WTf(a,c)}
function WTf(a,b){P(a.H[a.D],!1);P(a.H[b],!0);a.L.Ma(0!=b);a.J.Ma(b!=a.F.length-1);var c=a.Ea("waffle-autovis-lightbox-page-number");Gp(c,b+1);a.D=b}m.AXb=function(a){!Ep(this.Ka(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};m.BXb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&VTf(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||YTf(this);a.stopPropagation()};
m.EXb=function(){var a=this.Ea("waffle-autovis-lightbox-container");sp(a);this.H=[];UTf(this);VTf(this,this.D,!0)};m.Ozb=function(){this.close();PSf(this.F[this.D],2256)};m.DXb=function(){0!=this.D&&VTf(this,this.D-1,!0);0==this.D&&this.J.Ka().focus()};m.CXb=function(){YTf(this);this.D==this.F.length-1&&this.L.Ka().focus()};function YTf(a){a.D!=a.F.length-1&&VTf(a,a.D+1,!0)}m.close=function(){this.dispose()};m.od=function(){Q.prototype.od.call(this);var a=this.F[this.D];a&&a.Ka()&&a.Ka().focus()};
function ZTf(a){var b=a.name;a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+T(a.title)+'">'+R(b)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=Hx("Press enter to insert formula");return S(a+'"></span></div>')}function $Tf(a,b){Q.call(this);this.C=a;this.D=b}t($Tf,Q);m=$Tf.prototype;m.Ba=function(){var a=Uy(ZTf,{name:this.C,title:this.D});this.jb(a)};
m.Ga=function(){Q.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-quicksum-entry-name");sW(a);this.getHandler().listen(this.Ka(),"keypress",this.FWb);P(this.Ka(),!1)};m.getFunctionName=g("C");m.setValue=function(a){Gp(this.Ea("waffle-assistant-quicksum-entry-value"),a||"");P(this.Ka(),!!a)};m.isVisible=function(){return hx(this.Ka())};m.FWb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new Ho("insert",this)))};
function aUf(a,b,c,d,e){Q.call(this,e);this.Ha=a;this.Ca=b;this.L=c;this.O=d;this.D=a.C;this.ma=zz(vz(new uz,17));this.V=zz(vz(new uz,2));this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}t(aUf,Q);
aUf.prototype.Ga=function(){Q.prototype.Ga.call(this);this.Cf(new $Tf(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Cf(new $Tf(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Cf(new $Tf(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Cf(new $Tf(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Cf(new $Tf(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=
new k4e(this.Ka(),this.Ca,this.D,this.L);this.C.F=this.R;this.qa(this.C);this.getHandler().listen(this,"insert",this.xa).listen(this.C,"formula_inserted",this.Aa)};
aUf.prototype.refresh=function(a){function b(l){return h&&null!=l?ritz_api.RitzModelApi.renderNumberAsFormattedString(l,k):null}if(HI(this.D)){if(null==a){var c=KI(this.D),d=mJ(c);a=EI(this.D);if(!ad(d,c.Xq,c)){P(this.Ka(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=dTb(a,f.Lb(),f.Kb(),f.Oc(),f.Qc());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(LG(e)),d.push(e.ob());a=a[0].hb();this.J=null;a!=EI(this.D)&&(this.J=(a=xI(this.D,a))?a.ke():null);if(d=ritz_api.RitzModelApi.quickSum(d)){P(this.Ka(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.mc(0).setValue(b(d.sum));this.mc(1).setValue(b(d.average));this.mc(2).setValue(b(d.min));this.mc(3).setValue(b(d.max));1<a?this.mc(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):P(this.Ka(),!1);if(this.C){this.C.H=[];this.H=[];for(d=0;d<this.Zb();++d)a=this.mc(d),this.H.push(bUf(this,a.getFunctionName()));this.C.H=this.H}}else P(this.Ka(),!1)}else P(this.Ka(),!1)};
aUf.prototype.xa=function(a){var b=a.target;a=this.F[0];a=new Qm(a.left,a.Oc());b=b.getFunctionName();b=bUf(this,b);a=new mvd(KI(this.D),ln(a),b);this.L.C(a);this.O.C(2624,this.V)};aUf.prototype.Aa=function(){this.O.C(2624,this.ma)};function bUf(a,b){var c=a.Ha.L.D,d=a.J;a=Yc(a.F,function(e){return yM(e,d)});return"="+b+"("+a.join(c)+")"}
function p_(a,b,c,d,e,f,h){IW.call(this,h);this.Sa=a;this.qb=b.C;this.We=NM(b);this.Aa=c;this.$c=d;this.J=f;this.Qd=e;this.Ja=new aUf(b,c,d,f,this.oa());this.Fa(this.Ja);this.L=null;this.mb=this.dc=!1;this.fb=!0;this.Cd=$k();this.yb=this.bb=this.Ya=null;this.Ha=zz(vz(new uz,10))}t(p_,IW);m=p_.prototype;m.Ba=function(){IW.prototype.Ba.call(this);this.jb(Uy(cUf,{JT:this.We}))};
m.Ga=function(){IW.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-quicksum-panel");this.Ja.Ua(a);a=this.Ea("waffle-assistant-spinner-container");this.ue.render(a);a=this.ue;a.C="#4285f4";a.pb()&&W2e(a);a=this.Sa.C;this.getHandler().listen(this,"close-sidebar",this.qua).listen(a,"recommender-load-started",this.Wta).listen(a,"recommender-load-ended",this.Vta).listen(a,"recommender-calc-started",this.pta).listen(a,"recommender-calc-ended",this.nta).listen(this.Ea("waffle-assistant-scroll-pane"),
"scroll",MXe(this.Yga,10,this));a=mtb.isEnabled();this.Xga(!a)};m.resize=function(){var a=this.Ea("waffle-assistant-sidepane-content");a=ex(a).height;var b=this.Ea("waffle-assistant-spinner-container");Rw(b,"margin-top",a/2-16+"px");this.Yga()};m.iWa=ba();function dUf(a,b){var c=eUf(a);0!=c.length&&(Qf(a.L),c=c.filter(function(d){return d instanceof KSf}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new STf(c,b,a.Qd,a.J,a.oa()),a.L.render(),a.qa(a.L),TTf(a.L,a.mb)))}
m.Xga=function(a){this.mb=a;oy(this.Ka(),"waffle-assistant-readonly",a);var b=this.Ja;b.R=a;b.C&&(b.C.F=a);oy(b.Ka(),"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&TTf(this.L,a)};
m.setVisible=function(a){var b=this.isVisible();IW.prototype.setVisible.call(this,a);if(a&&!b){var c=PWe(this.Sa.C,a);c?(b=new L8d,L(b,1,Fn(c,"r")),L(b,2,Fn(c,"c")),L(b,3,c.xi()),c=new Bk,Yj(c,4,b),b=zz(yz(Az(this.Ha),c))):b=this.Ha;this.bb=al(this.Cd,"sett",!1,b);this.ue.setActive(!0);fUf(this)}a||gUf(this,!0)};m.Wta=function(){this.isVisible()&&(gUf(this,!0),this.ue.setActive(!0))};m.Vta=function(){this.isVisible()&&this.ue.setActive(!1)};
m.pta=function(a){this.isVisible()&&(this.J.C(2775,this.Ha),gUf(this,void 0,a.C,a.D),hUf(this)||this.ue.setActive(!0),fUf(this),this.fb=!1)};
m.nta=function(a){if(this.isVisible()){this.J.C(2776,this.Ha);var b=a.C;0<b.length&&(this.Ya=al(this.Cd,"serr"));gUf(this,!1);this.ue.setActive(!1);a=a.D;var c=uV(this.Sa.C),d=this.V.C.getActiveGrid();c=!!c&&!!d&&c.hb()!=d.hb();d=ja(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ja(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=Yg(k,1),n;if(!(n=!e.f1(l))&&(n=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}n=!l}n||f.push(k)}0<f.length?e.lS(f,a):e.mS(!0)}b=
ja(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==Yg(a,1)){this.R$();this.Ca=C(a,12);this.H=(c=HV(a))?LSe(no(c)):null;this.xa=C(a,11);iUf(this);a=this.H;c=!1;for(d=this.Na.length-1;0<=d;d--)e=this.Na[d],f=a,Rn(e,1)&&e.hb()==f.hb()&&fSf(HG(e),HG(f))&&fSf(IG(e),IG(f))&&(c=!0,this.Na.splice(d,1));this.Na.push(a);a=c;2!=this.Ca||a||jUf(this,!0)}b=eUf(this);0<b.length&&this.dc&&(b[b.length-1].$d=!0);this.dc=!1;fUf(this);kUf(this);this.Yga()}};
function fUf(a){var b=hUf(a),c=hx(a.Ea("waffle-assistant-quicksum-panel")),d=a.ue.Cb();b=b||c||d;c=a.Ea("waffle-assistant-empty-list");P(c,!b);P(a.ue.Ka(),b)}m.Jc=ba();m.xAa=ba();m.Ld=g("mb");m.qua=ba();m.ZQb=function(){this.Ya&&(this.Ya.complete(),this.Ya=null);this.bb&&(this.bb.complete(),this.bb=null);this.yb=Ka();this.fb||(this.J.C(2777,this.Ha),this.fb=!0)};
function lUf(){return S('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+R(utc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+R("Explore")+"</div></div>")}
function cUf(a,b){a=a||{};var c=S,d=Fx('<div class="waffle-assistant-replaceable-title">'+lUf(null,b)+"</div>");var e=e=a||{};e=e.JT;var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+R(utc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=(e?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.")+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more';f+='</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">';f+="Try it out";f+="</a></div></div></div>";e=S(f);e=S('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
(e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(R(dX(Cx({title:d,ll:Fx(""+e),id:"autovis",$w:"waffle-assistant-sidepanel",cka:"waffle-assistant-title",tV:"waffle-assistant-sidepane-content"},a),b)))}
function mUf(a,b,c,d,e,f,h,k,l,n){o_.call(this,a,LBb,d,e,f);var q=this;this.Ja=n;this.Ya=b;this.Ha=d;this.ib=e;this.mb=f;a=LG(d);this.J=yM(a);this.O=d.hb();this.Oa=new DTf(b,c);this.qa(this.Oa);this.H=this.F=null;this.xa=h;this.V=bC(new aC);this.qa(this.V);this.Ca=new Dz("",new yR,this.oa());this.Fa(this.Ca);yA(this.V,this.Ca,NBb);this.Aa=new Dz("",new yR,this.oa());this.Fa(this.Aa);yA(this.V,this.Aa,LBb);b=this.R.C.C.ke();this.ma=new SW(this.Ya,function(r,w,x){nUf(q,r,w,x)},!1,"e.g., A2:D5",!0,b,
this.oa());this.Fa(this.ma);this.Na=null;this.Pa=new uA(this);this.qa(this.Pa);this.bb=k;this.fb=l}t(mUf,o_);m=mUf.prototype;m.Ba=function(){this.jb(Uy(GTf))};
m.Ga=function(){o_.prototype.Ga.call(this);this.Ca.Ua(this.Ea("waffle-tables-popup-done"));this.Aa.Ua(this.Ea("waffle-tables-popup-cancel"));this.ma.render(this.Ea("waffle-assistant-tables-data-range-wrapper"));var a=this.Ea("waffle-range-selection-input");Ux(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().listen(a,"keydown",this.rXb).listen(a,"keyup",this.sXb).listen(a,"focusout",this.FKb).listen(this.R.C,"xa",this.uXb).listen(this.ma,"change",this.tXb);this.Pa.subscribe(NBb,
"action",this.vXb).subscribe(LBb,"action",this.nrb);oUf(this);a=this.Ea("waffle-tables-popup");oy(a,"waffle-tables-popup-answers-enabled",this.fb);var b=new XB(a,this.oa());this.qa(b);YB(b);a.focus()};m.Ia=function(){Qf(this.Na);o_.prototype.Ia.call(this)};function nUf(a,b,c,d){UV(a.bb,null,b,c,d,!1,void 0,function(e){a.Na=e})}
m.uXb=function(){for(var a=this.R.C,b=!0,c=ja(A0b(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.hb()==this.O){b=!1;break}b&&"number"===typeof DI(a)&&(this.O=DI(a),pUf(this,this.O));qUf(this)};function rUf(a){var b=a.Ea("waffle-assistant-table-canvas"),c=a.Ea("waffle-assistant-canvas-container");ETf(a.Oa,b,c,a.C,a.D,a.L)}m.nrb=function(){this.dispatchEvent("ge")};
m.vXb=function(){var a=!fpc.test(this.J);P(this.Za("waffle-assistant-tables-range-error"),a);oy(this.Ea("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.ib!=this.L||this.mb!=this.D;var b=!this.Ha.equals(this.C),c=this.Ha.hb()!=this.C.hb();if(a||b)a&&this.xa.C(35506),b&&this.xa.C(35507),c&&this.xa.C(35723),this.dispatchEvent(new CTf(KG(this.C),this.L,this.D,c));this.dispatchEvent("ge")}};
function oUf(a){var b=a.Ea("waffle-range-selection-input"),c=LG(a.Ha);a.J=yM(c);b.value=a.J;qUf(a);sUf(a);rUf(a)}m.Zga=function(a,b,c){o_.prototype.Zga.call(this,a,b,c);rUf(this)};
function tUf(a){var b=LI(a.R.C,a.O),c=b.Fb(),d=ipc(a.J,b),e=null!=d;if(e&&(b=D3b(b,d),e=Hn(b))){b=JG(b,c);var f=HG(b);c=IG(b);b=b.hb();d=jo(f);f=Rn(f,2)?Un(f,2):ritz_api.RitzModelApi.getNumberOfRows(b);var h=jo(c);c=Rn(c,2)?Un(c,2):ritz_api.RitzModelApi.getNumberOfColumns(b);c=dTb(b,d,h,f,c);a.Zga(c,uUf(a,c),a.D);qUf(a);sUf(a)}P(a.Za("waffle-assistant-tables-range-error"),!e)}function uUf(a,b){b=vUf(b,a.D);return a.L>b?b:a.L}
function vUf(a,b){a=0==b?a.Oc()-a.Lb():a.Qc()-a.Kb();return 0==a?3:Math.min(a-1,3)}
function qUf(a){if(a.Ja){P(Mp(a.oa(),"waffle-assistant-tables-data-range-label"),!1);Qf(a.H);var b=z(y(),"feuuc")?$G.getInstance():Eye.getInstance();a.H=new lW(void 0,b);a.H.setContent("Data Range");a.Fa(a.H);yA(a.V,a.H,OBb);a.H.render(a.Ea("waffle-assistant-tables-edit-sheet-button"));a.getHandler().listen(a.H,"action",a.JIb);b=0;for(var c=ja(A0b(a.R.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.hb()===a.O&&(b=a.H.Kh()),a.H.Pc(new Hz(d.ke(),d.hb()));a.H.Af(b)}}
function sUf(a){Qf(a.F);a.F=new lW(void 0,$G.getInstance());a.Fa(a.F);yA(a.V,a.F,MBb);a.F.render(a.Ea("waffle-assistant-tables-edit-headers-button"));a.getHandler().listen(a.F,"action",a.Hyb);for(var b=vUf(a.C,0),c=0;c<=b;c++){var d=(new iB("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.F.Pc(new Hz(d))}c=vUf(a.C,1);for(d=0;d<=c;d++){var e=(new iB("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.F.Pc(new Hz(e))}c=a.L;a.F.Af(0==a.D?c:c+b+1);a.F.setContent("Headers")}m.FKb=function(){var a=this.Ea("waffle-range-selection-input");this.J!=a.value&&(this.J=a.value,tUf(this))};m.tXb=function(){var a=this.ma.getValue();this.J=a;var b=this.Ea("waffle-range-selection-input");b.value=a;b.select();tUf(this)};m.JIb=function(){var a=this.H.getValue();a!=this.O&&(this.O=a,pUf(this,this.O));tUf(this)};
function pUf(a,b){if(a.Ja){var c=LI(a.R.C,b),d=on(mJ(c));ritz_api.TablesApi.getTables(JG(d,b).ob(),function(e){if(e.length){var f=e[0];e=f.getDimensionTableAccessor().getHeaderRange();var h=LG(io(ritz_api.RitzModelApi.toSerializedGridRangeProto(e)));e=f.getDimensionTableAccessor().getDimensionTagName();h=Fn(h,0==e?"r":"c");f=LG(io(ritz_api.TablesApi.getTableGridRange(f)))}else f=d,e=h=0;a.D=e;a.L=h;e=yM(f);a.J=e;e=a.Ea("waffle-range-selection-input");e.value=a.J;e.select();tUf(a)})}}
m.rXb=function(a){var b=this.Ea("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.J=b.value;tUf(this);NBb.kb();break;case 27:a.stopPropagation(),a.preventDefault(),oUf(this),LBb.kb()}};m.sXb=function(){this.J=this.Ea("waffle-range-selection-input").value;tUf(this)};m.Hyb=function(){var a=this.F.Ni(),b=vUf(this.C,0);this.Zga(this.C,a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};
function wUf(a,b,c,d,e,f,h,k,l,n,q,r){p_.call(this,a,b,c,e,d,f,r);this.ld=n;this.Lc=h;this.V=b;this.Va=new Q(this.oa());this.Fa(this.Va);this.R=new J4e(q);this.qa(this.R);this.D=[];this.F=null;this.Oa=new DA("",r,4);kz(this.Oa,2,!1);this.Fa(this.Oa);this.Tc=k;this.Hc=l;this.H=null;this.Ca=0;this.xa=null;this.ib=new Dz("",new yR,this.oa());this.Fa(this.ib);this.Bb=new Q(this.oa());this.Fa(this.Bb);this.wc=bC(new aC);this.qa(this.wc);yA(this.wc,this.ib,PBb);this.ma=this.O=null;this.Na=[]}t(wUf,p_);
m=wUf.prototype;
m.Ga=function(){var a=this;p_.prototype.Ga.call(this);this.Va.Ua(this.Ea("waffle-assistant-expanded-panel"));sW(this.C.Ka(),"Close");this.Bb.Ua(this.Ea("waffle-assistant-sidepane-tables-range"));iUf(this);this.ib.Ua(this.Ea("waffle-assistant-tables-edit-range-button"));if(NM(this.V)){var b=new hTf(this.Lc,this.Aa,this.qb,this.$c,this.J,this.R,this.V,this.Hc,this.ld,this.oa());this.Fa(b);this.D.push(b)}b=new BTf(this.J,this.R,this.oa());this.Fa(b);this.D.push(b);z(y(),"feedvs")&&(b=new rTf(this.J,
this.R,this.Aa,this.oa()),this.Fa(b),this.D.push(b));b=new NTf(this.Lc,this.qb,this.V,this.$c,this.J,this.R,this.Aa,this.ld,this.oa());this.Fa(b);this.D.push(b);b=new fTf(this.qb,this.Aa,this.Qd,this.J,this.R,this.oa());this.Fa(b);this.D.push(b);var c=this.Ea("waffle-assistant-features");Vc(this.D,function(d){d.render(c);a.Va.Fa(d.C,!0)});this.Oa.Ua(this.Ea("waffle-assistant-empty-list-learn-more"));this.getHandler().listen(this.Oa,"action",this.eXb).listen(this,"ge",this.R$).listen(this,"fe",this.fXb);
xUf(this)};m.fXb=function(){var a=yUf(this);a&&(a.Oa=!0)};m.eXb=function(){(Wt(),Tv).kb(Gye)};function kUf(a){Vc(a.D,function(b){aTf(b)})}function gUf(a,b,c,d){Vc(a.D,function(e){e.mS(b,c,d)})}function hUf(a){return!!bd(a.D,function(b){return b.Aua()})}m.Yga=function(){var a=this,b=this.Ea("waffle-assistant-scroll-pane").scrollTop+ex(this.Ea("waffle-assistant-sidepane-content")).height;Vc(this.D,function(c){a.F&&a.F!=c||(c instanceof fTf&&a.getHandler().Kc(c,"ae",a.ZQb),b=c.G6(b))})};
function eUf(a){if(a.F)return a.F.C.C;var b=[];Vc(a.D,function(c){pd(b,$Sf(c))});return b}m.Xga=function(a){p_.prototype.Xga.call(this,a);xUf(this)};m.iWa=function(a){Vc(this.D,function(b){b.fWa(a)})};m.xAa=function(){var a=this.Ea("waffle-assistant-replaceable-title"),b=this.Ea("waffle-assistant-title");dx(b,ex(a).height)};
m.Jc=function(){var a=this,b=this.Ea("waffle-assistant-scroll-pane-feature-content"),c=this.Ea("waffle-assistant-replaceable-title"),d=this.Va.Ka();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,P(d,!1),P(b,!0),Sy(c,lUf),Vx(c,"label"),this.resize(),OJ("Explore Opened");else if(this.F=bd(this.D,function(e){return e.Cb()}))P(b,!1),P(d,!0),this.F.C.setVisible(!0),bTf(this.F,c),Xx(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",OJ(b);this.xAa();b=new Mq(function(){var e=
NC.Az();e&&e.dispatchEvent("resize");a.Yga()},300);this.qa(b);b.start()};m.setVisible=function(a){var b=this.isVisible();p_.prototype.setVisible.call(this,a);a&&!b&&zUf(this,!0);a||this.R.clear()};m.qua=function(){p_.prototype.qua.call(this);this.F&&this.Jc();this.R$()};m.Wta=function(){p_.prototype.Wta.call(this);zUf(this,!0)};m.Vta=function(){p_.prototype.Vta.call(this);zUf(this,!1)};m.pta=function(a){p_.prototype.pta.call(this,a);zUf(this,!0,a.C)};
m.nta=function(a){p_.prototype.nta.call(this,a);zUf(this,!1)};function AUf(a,b){var c=yUf(a);if(b){var d=z(y(),"feenas");a.O=new mUf(a.V,a.Aa,a.Tc,a.H,a.Ca,a.xa,a.J,a.Hc,null!=c&&c.Cb(),d);a.Fa(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),Qf(a.O),a.O=null);c&&kTf(c,b)}function jUf(a,b){if(1!=a.xa){var c=yUf(a);b?(a.ma=new KTf(a.V,a.Aa,a.Tc,a.H,a.Ca,a.xa,null!=c&&c.Cb()),a.Fa(a.ma),a.ma.render(a.getElement())):a.ma&&(a.removeChild(a.ma,!0),Qf(a.ma),a.ma=null);c&&kTf(c,b)}}
function xUf(a){Vc(a.D,function(b){b.nS(a.Ld())})}function yUf(a){return(a=bd(a.D,function(b){return b instanceof hTf}))&&a}function zUf(a,b,c){Vc(a.D,function(d){d.Rn(b,c)});b&&(a.H=null,a.Ca=0,a.xa=null,a.R$(),iUf(a))}
function iUf(a){var b=a.Ea("waffle-sidebar-tables-bar"),c=a.Ea("waffle-assistant-scroll-pane");var d=null;var e=z(y(),"feenas"),f=uV(a.Sa.C);if(a.H||e&&f){if(a.H){var h=LG(a.H);f=a.H.hb();e&&(d=xI(a.V.C,f).ke())}else h=f.zc().C,d=f.ke(),a.H=JG(h,f.hb()),a.xa=0;d=yM(h,d);d=Uy(ITf,{GC:d});a=a.Bb.rb();sp(a);a.appendChild(d);P(b,!0);ky(c,"waffle-assistant-tables-scroll-pane")}else P(b,!1),my(c,"waffle-assistant-tables-scroll-pane")}m.R$=function(){AUf(this,!1);jUf(this,!1)};
function BUf(){var a='<div style="float:right;"><div class="'+T("waffle-inline-assistant-ignore-button")+'">';return S(a+"Ignore</div></div>")}function CUf(a){return S('<div class="'+T("waffle-assistant-input-reject-icon")+'" style="display:none">'+R(QB({icon:"docs-icon-img docs-icon-close"},a))+"</div>")}
function DUf(a,b){var c=a.column,d=a.Lac,e=a.Kac,f=a.CPb;a=a.dNb;var h='<div style="outline: none;margin-bottom: 12px;">';f?(h+='<div class="'+T("waffle-inline-assistant-nf-suggestion-description")+'">',h+="Numbers in this column are text</div>"):a&&(h+='<div class="'+T("waffle-inline-assistant-nf-suggestion-description")+'">',h+="There are multiple formats in this column</div>");h+='<div class="'+T("waffle-inline-assistant-recommendation-container")+'"><div class="'+T("waffle-inline-assistant-gridrange-chip")+
'">'+R(c)+CUf(b)+'</div><div class="'+T("waffle-inline-assistant-suggestion-row")+'">';if(f)h+='<div class="'+T("waffle-inline-assistant-nf-row")+'"><div class="'+T("waffle-inline-assistant-nf-suggested-preview")+" "+T("waffle-inline-assistant-nf-suggestion-text")+'">',h+="Convert to numbers</div></div>";else for(c=Math.max(0,Math.ceil(d.length)),f=0;f<c;f++){var k=f;h+='<div class="'+T("waffle-inline-assistant-nf-row")+'">'+(a?"":'<div class="'+T("waffle-inline-assistant-nf-original-preview")+" "+
T("waffle-inline-assistant-nf-suggestion-text")+'">'+R(d[k])+"</div>")+'<div class="'+T("waffle-inline-assistant-nf-suggested-preview")+" "+T("waffle-inline-assistant-nf-suggestion-text")+'">'+R(e[k])+"</div></div>"}h+='</div><div class="'+T("waffle-assistant-card-feedback")+" "+T("waffle-assistant-in-cell-card-feedback")+'"></div><div class="'+T("waffle-inline-assistant-nf-check")+'">'+R(QB({icon:"docs-icon-img docs-icon-check"},b))+"</div></div></div>";return S(h)}
function EUf(a){var b=a.Lg;a=a.SGa;b='<div style="outline: none"><div class="'+T("waffle-inline-assistant-recommendation-container")+'"><div class="'+T("waffle-inline-assistant-gridrange-chip")+'">'+R(b)+'</div><div class="'+T("waffle-inline-assistant-suggestion-row")+'"><div class="'+T("waffle-inline-assistant-tw-row")+'">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=Dx(e,null)?'<div class="'+T("waffle-inline-assistant-tw-space")+'"></div>':R(e)}return S(b+"</div></div></div></div>")}
function FUf(a,b){a=a.Bya;b='<div class="'+T("waffle-inline-assistant-suggestion-row-overflow-button docs-material")+'">'+R(QB({icon:"docs-icon-img docs-icon-chevron-down-24"},b));a="See "+(R(a)+" more");return S(b+a+"</div>")}
function GUf(a,b){var c=a.gT;a=a.Obb;for(var d='<div style="outline: none; overflow:hidden;">',e=Math.max(0,Math.ceil(Math.min(3,c.length))),f=0;f<e;f++){var h=f;d+=EUf({Lg:c[h],SGa:a[h]})}if(3<c.length){d+=FUf({Bya:c.length-3},b)+'<div class="'+T("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)f=3+e,d+=EUf({Lg:c[f],SGa:a[f]});d+="</div>"}d+='<div style="float:right"><div class="'+T("waffle-inline-assistant-accept-button")+
'">';d=d+"Trim all whitespace</div></div>"+(BUf()+'<div style="float:right"><div class="'+T("waffle-assistant-card-feedback")+'"></div></div></div>');return S(d)}function HUf(){var a='<div class="'+T("waffle-inline-assistant-sidebar-toast")+'"><div class="'+T("waffle-inline-assistant-toast-undo-button")+'">';a=a+'Undo</div><div class="'+(T("waffle-inline-assistant-toast-text")+'"></div></div>');return S(a)}
function IUf(a){a=a.u6b;a=zT(new iB("{NUM_CELLS_CHANGED_1,plural,=1{Change applied to {NUM_CELLS_CHANGED_2} cell}other{Change applied to {NUM_CELLS_CHANGED_2} cells}}"),{NUM_CELLS_CHANGED_1:a,NUM_CELLS_CHANGED_2:R(a)});return S(a)}function JUf(a){a="Column "+(R(a.Bcb)+" format applied");return S(a)}
function KUf(a){a=a.x6b;a=zT(new iB("{NUM_ROWS_REMOVED_1,plural,=1{{NUM_ROWS_REMOVED_2} row removed}other{{NUM_ROWS_REMOVED_2} rows removed}}"),{NUM_ROWS_REMOVED_1:a,NUM_ROWS_REMOVED_2:R(a)});return S(a)}
function LUf(a,b){a='<div class="waffle-inline-assistant-sidebar-insights-cta-container"><div class="waffle-inline-assistant-sidebar-divider"></div><div class="waffle-inline-assistant-sidebar-insights-header">Get more insights about your data</div>'+R(CA({Yc:"waffle-inline-assistant-sidebar-insights-cta",content:"Review column stats",style:2},b));return S(a+"</div>")}
function MUf(a){var b=a.FAa,c=a.Q2;a=a.wq;b='<div style="outline: none"><div class="'+T("waffle-inline-assistant-recommendation-container")+'">'+(a?'<div class="'+T("waffle-inline-assistant-rd-deleted-strikethrough")+'"></div><div class="'+T("waffle-inline-assistant-gridrange-chip")+'">'+R(b+1)+"</div>":'<div class="'+T("waffle-inline-assistant-gridrange-chip")+" "+T("waffle-inline-assistant-gridrange-chip-neutral")+'">'+R(b+1)+"</div>")+'<div class="'+T("waffle-inline-assistant-suggestion-row")+
'"><div class="'+T("waffle-inline-assistant-rd-cell-preview")+'">';a=c.length;for(var d=0;d<a;d++)b+=R(c[d])+'<div class="'+T("waffle-inline-assistant-rd-cell-value-divider")+'"></div>';return S(b+"</div></div></div></div>")}
function NUf(a,b){var c=a.Bcc;a=a.Q2;for(var d='<div tabindex=0 role="region" style="overflow:hidden; outline:none">'+MUf({FAa:c[0],Q2:a,wq:!1}),e=Math.max(0,Math.ceil(Math.min(3,c.length)-1)),f=0;f<e;f++)d+=MUf({FAa:c[1+f],Q2:a,wq:!0});if(3<c.length){d+=FUf({Bya:c.length-3},b)+'<div class="'+T("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)d+=MUf({FAa:c[3+e],Q2:a,wq:!0});d+="</div>"}d+='<div style="float:right"><div class="'+
T("waffle-inline-assistant-accept-button")+'">';d=d+"Remove</div></div>"+(BUf()+'<div style="float:right; position: relative;"><div class="'+T("waffle-assistant-card-feedback")+'"></div></div></div>');return S(d)}function OUf(a){a=a.Nha;a=zT(new iB("{NUM_OVERFLOW_CARDS_1,plural,=1{Show {NUM_OVERFLOW_CARDS_2} more suggestion}other{Show {NUM_OVERFLOW_CARDS_2} more suggestions}}"),{NUM_OVERFLOW_CARDS_1:a,NUM_OVERFLOW_CARDS_2:R(a)});return S(a)}
function PUf(a,b){var c=a.Mbb;a=a.Nha;return S('<div class="'+T("waffle-inline-assistant-sidebar-category-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-category-header")+'"><div class="'+T("waffle-inline-assistant-sidebar-category-label")+'">'+R(c)+'</div></div><div class="'+T("waffle-inline-assistant-sidebar-category-cards")+'"></div><div class="'+T("waffle-inline-assistant-sidebar-category-show-more-button docs-material")+'">'+R(QB({icon:"docs-icon-img docs-icon-chevron-down-24"},
b))+OUf({Nha:a},b)+"</div></div>")}function QUf(a){var b=a.t6b,c=a.$J;a='<div class="'+T("waffle-assistant-anomaly-description")+'">';1==b?(b='This cell is not a <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"</span>"),a+=b):1<b&&(b='These cells are not <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"s</span>"),a+=b);return S(a+"</div>")}function RUf(a){return S(R(QB({icon:"docs-icon-img docs-icon-check"},a)))}
function SUf(a,b){var c=a.RGa;a=a.TGa;c='<div tabindex=0 role="textbox" class="'+T("waffle-assistant-card-single-anomaly")+" "+T("waffle-assistant-card-single-anomaly"+c)+'" style="outline: none;"><div class="'+T("waffle-assistant-input-container")+" "+T("waffle-assistant-input-container"+c)+'"><div class="'+T("waffle-inline-assistant-gridrange-chip")+'">'+R(c)+CUf(b)+'</div><div class="'+T("waffle-assistant-form")+'">';c+='<div class="'+T("waffle-assistant-card-feedback")+" "+T("waffle-assistant-in-cell-card-feedback")+
'"></div><div class="'+T("waffle-assistant-input-edit-icon")+'">'+R(QB({icon:"docs-icon-img docs-icon-edit-outline-20"},b))+'</div><div class="'+T("waffle-assistant-input-return-icon")+'" style="display:none">'+RUf(b)+'</div><input type="text" class="'+T("jfk-textinput")+" "+T("waffle-assistant-anomaly-input")+'" placeholder="'+T("New cell value")+'" aria-label="'+T("New cell value")+'" value="'+T(a)+'"/></div></div></div>';return S(c)}
function TUf(a,b){var c=a.Nbb;a=a.Qbb;var d='<div tabindex=0 role="region" class="'+T("waffle-assistant-anomaly-card")+'"><div tabindex="0" role="textbox" class="'+T("waffle-anomaly-grey-out")+" "+T("waffle-assistant-card-anomaly")+'"></div><div class="'+T("waffle-anomaly-apply-all-hint")+'" style="display:none">';d+="Input for all instances";var e=a[0];e=S('<div tabindex=0 role="textbox" class="'+T("waffle-assistant-card-apply-all")+'" style="outline: none;"><div class="'+T("waffle-assistant-input-container")+
'"><div class="'+T("waffle-assistant-form")+'"><input type="text" class="'+T("jfk-textinput")+" "+T("waffle-assistant-anomaly-input")+" "+T("waffle-inline-assistant-apply-all-input-box")+'" placeholder="New value for all anomalies" aria-label="'+T(e)+'" value="'+T(e)+'"/><div class="'+T("waffle-assistant-input-return-icon")+'" style="display:none">'+RUf(b)+"</div></div></div></div>");d+="</div>"+e;e=Math.max(0,Math.ceil(Math.min(3,c.length)));for(var f=0;f<e;f++){var h=f;d+=SUf({RGa:c[h],TGa:a[h]},
b)}if(3<c.length){d+=FUf({Bya:c.length-3},b)+'<div class="'+T("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';e=Math.max(0,Math.ceil(c.length-3));for(f=0;f<e;f++)h=3+f,d+=SUf({RGa:c[h],TGa:a[h]},b);d+="</div>"}d+='<div class="'+T("waffle-assistant-anomaly-apply-all-container")+'"><div class="'+T("waffle-assistant-anomaly-apply-to-all-text")+'">';d=d+'Apply to all</div><div class="'+(T("waffle-assistant-anomaly-apply-all-check")+'"></div></div></div>');return S(d)}
function UUf(a,b,c,d){A.call(this);this.H=a;this.D=b;this.J=c;this.$a=d||null}t(UUf,QT);
UUf.prototype.C=function(a){var b=this,c=[],d=new Hz("Suggestion is incorrect",null,this.$a);d.Gc("apps-menuitem");c.push(d);yA(a,d,this.H,void 0,function(){return VUf(b,"Suggestion is incorrect")},this.D);d=new Hz("Suggestion is not critical",null,this.$a);d.Gc("apps-menuitem");c.push(d);yA(a,d,this.H,void 0,function(){return VUf(b,"Suggestion is not critical")},this.D);d=new Hz("Other",null,this.$a);d.Gc("apps-menuitem");c.push(d);yA(a,d,this.H,void 0,function(){return VUf(b,"Other")},this.D);c.push(null);
d=Uy(O9e);d=new Hz(d,null,this.$a);d.Gc("apps-menuitem");c.push(d);yA(a,d,this.H,void 0,function(){return VUf(b,"Other")},this.D);return c};function VUf(a,b){return new wXe({description:b},a.J,a.D)}var WUf={Nmc:"anomaly",W7a:"remove-duplicates",hKc:"number-format",d9a:"trim-whitespace"};
function q_(a,b,c,d,e){Q.call(this,e);var f=this;this.bb=a;this.mb=b;this.D=UJ(b);this.C=c;this.Ya=d;this.fb=new FW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.fb);this.J=new FW(b,"waffle-assistant-mouseover-highlight-styled-border","waffle-assistant-mouseover-highlight-styled-rect");this.qa(this.J);this.Na=new FW(b,"waffle-assistant-mouseover-highlight-styled-border-red","waffle-assistant-mouseover-highlight-styled-rect-red");this.qa(this.Na);
this.Ja=new DA;this.Fa(this.Ja);this.V=new wA(void 0,void 0,void 0,$B.getInstance());this.qa(this.V);this.qb=new voe(function(){return f.V},this.oa());this.qa(this.qb);this.yb=zz(vz(new uz,76));this.O=null;this.Ha={};this.Bb=new uA(this);this.qa(this.Bb);this.xa=[];this.Ca=[];this.ma=null}t(q_,Q);m=q_.prototype;m.x3=ea("waffle-inline-assistant-ignore-button");
function XUf(a,b){var c=new DA,d=a.Ca.length;c.Ua(a.Qf(a.x3())[d]);a.Ca.push(c);var e=b?{card:a}:{card:a,Zfc:d};yA(a.V,c,Xsb,zA,function(){return e},YUf(a))}m.Ga=function(){Q.prototype.Ga.call(this);var a=this.Ka();this.getHandler().listen(a,"mouseenter",this.X6).listen(a,"mouseleave",this.nZ);ZUf(this);a=this.Qf(this.x3()).length;for(var b=1===a,c=0;c<a;c++)XUf(this,b);if(a=this.Za("waffle-inline-assistant-suggestion-row-overflow-button"))this.Ja.Ua(a),this.getHandler().listen(this.Ja,"action",this.g5b)};
m.Ia=function(){Q.prototype.Ia.call(this);this.AN()};m.X6=function(){r_(this,!0);GW(this.fb);E4e(this.J,this.C);this.AN();this.t8()};m.nZ=function(){r_(this,!1);this.AN();GW(this.J);this.Ka().blur()};function $Uf(a){null==a.ma&&(a.ma=aRc(a.D))}function aVf(a){a.ma&&(OP(a.D,a.ma.y,a.ma.x),a.ma=null)}function YUf(a){return zz(yz(vz(new uz,76),a.Cha()))}m.g5b=function(){this.Ya.C(36812,YUf(this));var a=this.Ea("waffle-inline-assistant-overflow-suggestions");P(a,!0);this.Ja.Ma(!1);this.Ja.setVisible(!1)};
function ZUf(a){if(z(y(),"fedpsf")&&!(0<a.xa.length))for(var b=a.Qf("waffle-assistant-card-feedback"),c={},d=0;d<b.length;c={HF:c.HF},d++){var e=b[d];c.HF=new o$e(a.oa());a.Fa(c.HF);a.xa.push(c.HF);var f=new UUf(btb,a.yb,a.Ha,a.oa());xoe(a.qb,c.HF.xb(),[f]);c.HF.render(e);c.HF.setVisible(!1);a.getHandler().listen(c.HF.xb(),"afterhide",function(h){return function(){h.HF.setVisible(!1)}}(c))}}m.isVisible=function(){return this.Za("waffle-inline-assistant-gridrange-chip")?!0:!1};
function s_(a){return a.C.map(function(b){return b.rect})}m.Fra=ea(null);function r_(a,b){1===a.xa.length&&(a=a.xa[0],b?a.setVisible(!0):b||a.xb().isVisible()||a.setVisible(!1))}
function bVf(a,b,c,d,e,f,h,k){c.sort(function(l,n){return l.rect.top-n.rect.top});q_.call(this,a,b,c,h,k);this.Oa=d;this.H=this.C.map(function(l){return yM(l.rect)});this.Va=Yc(c,function(l){return l.rect.top});this.L=e;this.R=new hR(this.oa());this.Fa(this.R);this.Pa=new Q;this.Fa(this.Pa);this.Aa=new Q;this.Fa(this.Aa);this.Sa=null;this.ib=f}t(bVf,q_);m=bVf.prototype;m.Cha=function(){var a=new Bk;L(a,21,3);var b=new X8d;L(b,2,cVf(this.Oa));Yj(a,26,b);b=new Ck;L(b,1,1);vTe(a,b);return a};m.zS=ea("anomaly");
m.Fra=function(a,b){for(var c=b.length-1;0<=c;c--)this.L.splice(b[c],1);b=!1;this.ib&&1<a.length&&(b=!0);return new bVf(this.bb,this.mb,a,this.Oa,this.L,b,this.Ya)};m.Ba=function(){var a=Uy(TUf,{Nbb:this.H,Qbb:this.L});this.jb(a);a={};this.Ha=(a.recommendationCategory="CATEGORICAL_ANOMALY",a.recommendationRange=this.H.join(","),a)};
m.Ga=function(){var a=this;q_.prototype.Ga.call(this);for(var b=this.Qf("jfk-textinput"),c=this.Qf("waffle-assistant-card-single-anomaly"),d=this.Qf("waffle-inline-assistant-gridrange-chip"),e=this.Qf("waffle-assistant-input-edit-icon"),f=this.Qf("waffle-assistant-input-return-icon"),h={Lv:0};h.Lv<this.H.length;h={KO:h.KO,dla:h.dla,U_:h.U_,Lv:h.Lv,q9:h.q9,t9:h.t9,CJ:h.CJ},h.Lv++){h.CJ=b[h.Lv+1];var k=f[h.Lv+1];h.KO=this.H[h.Lv];h.dla=this.L[h.Lv];var l=c[h.Lv];h.q9=d[h.Lv];var n=e[h.Lv];h.U_=this.xa[h.Lv];
h.t9=this.Ca[h.Lv];this.getHandler().listen(h.CJ,["mousedown","click","mouseup","keydown"],function(q){return void q.stopPropagation()}).listen(h.CJ,"input",function(q){return function(){dVf(a,q.KO,!0,null)}}(h)).listen(h.CJ,"focus",function(q){return function(){var r=q.KO,w=q.dla,x=q.U_,F=a.Ea("waffle-assistant-input-container"+r);eVf(a,r)!==w?dVf(a,r,!0,null):ky(F,"waffle-assistant-input-container-focused");r=gp("waffle-assistant-input-edit-icon",F);P(r,!1);F=gp("waffle-inline-assistant-gridrange-chip",
F);ky(F,"waffle-inline-assistant-gridrange-chip-hovered");x.setVisible(!1)}}(h)).listen(h.CJ,"blur",function(q){return function(){return fVf(a,q.KO)}}(h)).listen(h.CJ,"keydown",function(q){return function(r){return gVf(a,r,q.KO)}}(h)).listen(l,"mouseenter",function(q){return function(){var r=q.q9,w=q.U_,x=q.t9,F=a.C[q.Lv];r_(a,!0);$Uf(a);OP(a.D,F.rect.top,F.rect.left);a.R.isChecked()?E4e(a.J,a.C):HW(a.J,F);ky(r,"waffle-inline-assistant-gridrange-chip-hovered");r=r.childNodes[0];a.Sa=r.nodeValue;r.nodeValue=
"";x.setVisible(!0);w.setVisible(!0)}}(h)).listen(l,"mouseleave",function(q){return function(){var r=q.q9,w=q.U_,x=q.t9;r_(a,!1);GW(a.J);my(r,"waffle-inline-assistant-gridrange-chip-hovered");w.xb().isVisible()||w.setVisible(!1);r.childNodes[0].nodeValue=a.Sa;a.Sa=null;x.setVisible(!1)}}(h)).listen(n,"click",function(q){return function(){var r=q.CJ;r.focus();r.selectionStart=r.selectionEnd=r.value.length}}(h)).listen(k,"click",function(q){return function(){return hVf(a,q.KO)}}(h)).listen(this.R,"change",
this.nsb)}this.Aa.Ua(this.Ea("waffle-anomaly-grey-out"));P(this.Aa.Ka(),!1);b=this.Ea("waffle-assistant-card-apply-all");Rw(b,"height","0px");c=gp("waffle-assistant-input-return-icon",b);this.getHandler().listen(b,"keydown",function(q){return gVf(a,q,null)}).listen(c,"click",this.kOa).listen(b,"input",this.sOa);this.Pa.Ua(this.Ea("waffle-assistant-anomaly-apply-all-container"));this.ib||P(this.Pa.Ka(),!1);this.R.Ua(this.Ea("waffle-assistant-anomaly-apply-all-check"))};
m.nsb=function(){this.Za("waffle-assistant-card-single-anomaly");var a=this.Ea("waffle-assistant-card-apply-all"),b=this.Qf("waffle-assistant-input-edit-icon");if(this.R.isChecked()){P(this.Aa.Ka(),!0);var c=this.Ea("waffle-anomaly-apply-all-hint");P(c,!0);Rw(a,"z-index","1000");Rw(a,"height","39px");Rw(a,"margin-top","10px");a=gp("waffle-assistant-input-container",a);this.Ea("waffle-inline-assistant-apply-all-input-box").value!==this.L[0]?this.sOa():ky(a,"waffle-assistant-input-container-focused");
for(a=0;a<b.length;a++)P(b[a],!1)}else{P(this.Aa.Ka(),!1);Rw(a,"z-index","");Rw(a,"height","0px");Rw(a,"margin-top","");a=gp("waffle-assistant-input-container",a);my(a,"waffle-assistant-input-container-focused");my(a,"waffle-assistant-input-container-changed");for(c=0;c<this.H.length;c++)dVf(this,this.H[c],!1,this.L[c]);c=this.Ea("waffle-anomaly-apply-all-hint");P(c,!1);my(c,"waffle-anomaly-apply-all-hint-changed");a=gp("waffle-assistant-input-return-icon",a);P(a,!1);for(a=0;a<b.length;a++)P(b[a],
!0),fVf(this,this.H[a])}};m.x3=ea("waffle-assistant-input-reject-icon");m.sOa=function(){var a=this.Ea("waffle-assistant-card-apply-all"),b=gp("waffle-assistant-input-container",a);ky(b,"waffle-assistant-input-container-changed");b=this.Ea("waffle-inline-assistant-apply-all-input-box").value;for(var c=0;c<this.H.length;c++)dVf(this,this.H[c],!1,b);b=this.Ea("waffle-anomaly-apply-all-hint");ky(b,"waffle-anomaly-apply-all-hint-changed");a=gp("waffle-assistant-input-return-icon",a);P(a,!0)};
function dVf(a,b,c,d){a=a.Ea("waffle-assistant-input-container"+b);c?(ky(a,"waffle-assistant-input-container-changed"),c=gp("waffle-assistant-input-return-icon",a),P(c,!0)):gp("jfk-textinput",a).value=d;c=gp("waffle-inline-assistant-gridrange-chip",a);ky(c,"waffle-inline-assistant-gridrange-chip-changed")}function gVf(a,b,c){switch(b.keyCode){case 13:a.R.isChecked()?a.kOa():hVf(a,c)}}
m.kOa=function(){for(var a=this.Ea("waffle-inline-assistant-apply-all-input-box"),b=[],c=ja(this.C),d=c.next();!d.done;d=c.next())(d=d.value)&&(b=b.concat(d.rect));c=YUf(this);d=new Ck;L(d,1,b.length);ak(c.C,10,[d]);Wsb.kb({card:this,VGa:b,newValue:a.value},c)};function hVf(a,b){var c=a.D.Ra(),d=eVf(a,b);b=ipc(b,c);Wsb.kb({card:a,VGa:[b],newValue:d},YUf(a))}
function fVf(a,b){a=a.Ea("waffle-assistant-input-container"+b);b=gp("waffle-assistant-input-return-icon",a);if(document.querySelector(".waffle-assistant-input-return-icon:active")!==b){my(a,"waffle-assistant-input-container-focused");my(a,"waffle-assistant-input-container-changed");var c=gp("waffle-assistant-input-edit-icon",a);P(c,!0);P(b,!1);a=gp("waffle-inline-assistant-gridrange-chip",a);my(a,"waffle-inline-assistant-gridrange-chip-changed");my(a,"waffle-inline-assistant-gridrange-chip-hovered")}}
m.X6=function(){r_(this,!0);GW(this.fb)};m.nZ=function(){q_.prototype.nZ.call(this);aVf(this)};m.e$=function(a,b){var c=this.C[a];c=new Jn(c.C,new jn(c.rect.top-b,c.rect.left,c.rect.top-b+c.rect.height,c.rect.left+c.rect.width));this.C[a]=c;this.Va[a]-=b;null!==this.Za("waffle-inline-assistant-gridrange-chip")&&(this.Qf("waffle-inline-assistant-gridrange-chip")[a].childNodes[0].nodeValue=yM(c.rect))};m.AN=ba();m.t8=ba();
function eVf(a,b){a=a.Ea("waffle-assistant-input-container"+b);return(a=gp("jfk-textinput",a))?a.value:null}m.getColumnType=g("Oa");function cVf(a){switch(a.toUpperCase()){case "LOCATION":return 11;case "ADDRESS":return 12;case "PHONE NUMBER":return 13;case "COMPANY":return 14;case "FAMOUS PEOPLE":return 15;case "STOCK":return 16;case "DATETIME":return 7;case "EMAIL ADDRESS":return 9;default:return 0}}
function iVf(a,b,c){a=Tle(a.L);switch(b){case 4:case 5:case 6:case 7:a=ja(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value.tE,d.getType()===b)return Yg(d,2)}return c}function jVf(a,b){a=ritz_api.TablesApi.getCurrentlyDetectedTables(gSf(a.Fb()).ob());return a.length?bd(a,function(c){return LG(io(ritz_api.TablesApi.getTableGridRange(c))).intersects(b)}):null}
function kVf(){this.Aa=!1;this.J=[];this.R=[];this.O=[];this.ma=[];this.L=[];this.V=[];this.F=[];this.H=[];this.xa=[];this.C=this.D=this.Ca=this.Ha=null}function lVf(a,b,c,d,e,f,h,k){a.Ha=b;a.J=c;a.R=d;a.O=e;a.ma=f;a.L=h;a.V=k}function mVf(a,b,c,d,e){A.call(this);this.H=a;this.F=b;this.C=e;this.D=JV(this.F)}t(mVf,A);
function nVf(a,b){if(z(y(),"fecad")){var c=FM(a.H);if(c){a.C.F=[];a.C.H=[];a.C.xa=[];var d=ritz_api.RitzModelApi.getWorkbookRangesForSheet(a.D,12);d=ja(d);for(var e=d.next();!e.done;e=d.next()){var f=e.value;e=Pn(VZc,ritz_api.RitzModelApi.getWorkbookRangePropertiesDeltaProtoById(f));if(f=ritz_api.RitzModelApi.getWorkbookRangeById(f,!1))if(f=io(f),f.hb()===c.Fb()){var h=new jn(f.Lb(),f.Kb(),f.Oc(),f.Qc());h=new Jn(a.D,h);e=Xn(e.Xh(11,NRf),4);a.C.F.push(h);a.C.H.push(e);e=XI(c.ah(f.Lb(),f.Kb()));a.C.xa.push(e);
b.push(h)}}}}}function oVf(a,b,c,d,e,f){q_.call(this,a,b,[c],e,f);this.Va=d;this.H=C(d,1);this.R=C(d,4);this.L=d.getPattern();this.Sa=C(d,5);this.Oa=new Cl;this.Aa=new DA;this.Fa(this.Aa);this.Pa=null}t(oVf,q_);m=oVf.prototype;
m.Ga=function(){var a=this;q_.prototype.Ga.call(this);this.Aa.Ua(this.Ea("waffle-inline-assistant-nf-check"));yA(this.V,this.Aa,Vsb,zA,function(){return a},YUf(this));var b=this.Ea("waffle-inline-assistant-recommendation-container");this.getHandler().listen(b,"mouseenter",this.jCb).listen(b,"mouseleave",this.mCb)};m.Cha=function(){var a=new Bk;L(a,21,1);L(a,22,this.L);L(a,24,this.R);return a};m.zS=ea("number-format");
m.Ba=function(){var a=tM(this.C[0].rect.left),b=pVf(this,this.R),c=pVf(this,this.H,this.L);b=Uy(DUf,{column:a,Lac:b,Kac:c,CPb:1===this.R&&(2===this.H||4===this.H||3===this.H),dNb:1<this.Sa});this.jb(b);b=qVf(this.H);c={};this.Ha=(c.recommendationCategory="NUMBER_FORMAT",c.recommendationRange=a,c.recommendationType=b.toLocaleUpperCase(),c.recommendationPattern=this.L,c);if("#,##0.00;(#,##0.00)"===this.L||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===this.L)a=this.Ea("waffle-inline-assistant-recommendation-container"),
b=this.Ea("waffle-inline-assistant-gridrange-chip"),c=this.Ea("waffle-assistant-input-reject-icon"),dx(a,"72px"),dx(b,"72px"),Rw(b,"line-height","72px"),dx(c,"72px"),Rw(c,"line-height","72px")};
function pVf(a,b,c){if(1===b)return["TEXT"];var d=new gh;d.setType(b);D(d,3,1);c&&d.setPattern(c);if("#,##0.00;(#,##0.00)"===c||"#,##0.00;(#,##0.00)"===a.L||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===c||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===a.L)return[ritz_api.RitzModelApi.renderNumberAsFormattedString(1000.12,El(a.Oa.ob(d),ag)),ritz_api.RitzModelApi.renderNumberAsFormattedString(-1000.12,El(a.Oa.ob(d),ag))];b=1000.12;5===a.R||6===a.R||7===a.R||5===a.H||6===a.H||7===
a.H?b=39717.66597222222:3===a.H&&(b=.1012);return[ritz_api.RitzModelApi.renderNumberAsFormattedString(b,El(a.Oa.ob(d),ag))]}function qVf(a){switch(a){case 1:return"Text";case 2:return"Number";case 3:return"Percent";case 4:return"Currency";case 5:return"Date";case 6:return"Time";case 7:return"Date time";case 8:return"Scientific";default:return"Unknown"}}
m.jCb=function(){var a=this.C[0].rect;$Uf(this);OP(this.D,Math.max(0,a.top-2),a.left);a=this.Ea("waffle-inline-assistant-gridrange-chip");ky(a,"waffle-inline-assistant-gridrange-chip-hovered");HW(this.J,this.C[0]);a=a.childNodes[0];this.Pa=a.nodeValue;a.nodeValue="";this.Ca[0].setVisible(!0)};m.x3=ea("waffle-assistant-input-reject-icon");
m.mCb=function(){var a=this.Ea("waffle-inline-assistant-gridrange-chip");my(a,"waffle-inline-assistant-gridrange-chip-hovered");GW(this.J);aVf(this);a.childNodes[0].nodeValue=this.Pa;this.Pa=null;this.Ca[0].setVisible(!1)};m.X6=function(){r_(this,!0);this.AN();this.t8();var a=this.Ea("waffle-inline-assistant-nf-row");ky(a,"waffle-inline-assistant-nf-row-with-feedback")};m.nZ=function(){r_(this,!1);this.Ka().blur();this.AN();var a=this.Ea("waffle-inline-assistant-nf-row");my(a,"waffle-inline-assistant-nf-row-with-feedback")};
m.e$=ba();m.t8=function(){this.O=ritz_api.GridViewApi.previewRangeWithNf(this.D.L.H,LSe(this.C[0]).ob(),this.bb,this.H,this.L);eKc(this.D,[this.C[0].rect])};m.AN=function(){this.O&&(ritz_api.GridViewApi.clearTransform(this.D.L.H,this.O),this.O=null,this.D.isDisposed()||eKc(this.D,[this.C[0].rect]))};function rVf(a){var b=new gh;b.setPattern(a.L);b.setType(a.H);return b}
function sVf(a,b,c,d,e){Q.call(this,e);this.H=a;this.C=b;a=ja(b);for(b=a.next();!b.done;b=a.next())this.qa(b.value);this.J=c;this.L=d;this.D=new Q(e);this.Fa(this.D);this.F=new DA;this.Fa(this.F)}t(sVf,Q);
sVf.prototype.Ba=function(){var a=this;Q.prototype.Ba.call(this);var b=Uy(PUf,{Mbb:this.J,Nha:this.C.length-3});this.jb(b);this.D.Ua(this.Ea("waffle-inline-assistant-sidebar-category-cards"));if("anomaly"===this.H)tVf(this).forEach(function(c){for(var d=0,e=0;e<c.length;e++){var f=s_(c[e]);d+=f.length}d=Uy(QUf,{t6b:d,$J:c[0].getColumnType()});a.D.Ka().appendChild(d);for(d=0;d<c.length&&3>d;d++)a.D.Fa(c[d],!0)});else for(b=0;b<this.C.length&&3>b;b++)this.D.Fa(this.C[b],!0)};
function tVf(a){var b=new Map;if("anomaly"!==a.H)return b;for(var c=0;c<a.C.length;c++){var d=a.C[c],e=s_(d)[0];if(b.has(e.left)){var f=b.get(e.left);f=f.concat(d);b.set(e.left,f)}else b.set(e.left,[d])}return b}sVf.prototype.Ga=function(){Q.prototype.Ga.call(this);this.F.Ua(this.Ea("waffle-inline-assistant-sidebar-category-show-more-button"));"anomaly"===this.H||3>=this.C.length?uVf(this):this.getHandler().listen(this.F,"action",this.O)};
function vVf(a,b){var c=a.C.indexOf(b);a.C.splice(c,1);if(b.isVisible()){if("anomaly"===a.H){c=b.Ka().previousElementSibling;var d=tVf(a),e=s_(b)[0].left;d.has(e)||(d=a.D.Ka(),jy(c,"waffle-assistant-anomaly-description"),d.removeChild(c))}a.D.removeChild(b,!0)}else a.C.length===a.D.Zb()?uVf(a):(c=Uy(OUf,{Nha:a.C.length-a.D.Zb()}),a.F.Ka().childNodes[1].nodeValue=c.textContent);b.dispose()}
sVf.prototype.O=function(){for(var a=this.D.Zb();a<this.C.length;a++)this.D.Fa(this.C[a],!0);uVf(this);a=new Bk;L(a,23,this.C.length);switch(this.H){case "anomaly":L(a,21,3);break;case "remove-duplicates":L(a,21,4);break;case "number-format":L(a,21,1);break;case "trim-whitespace":L(a,21,2)}a=zz(yz(vz(new uz,76),a));this.L.C(36811,a)};function uVf(a){a.F.Ma(!1);a.F.setVisible(!1)}
function wVf(a,b,c,d,e,f){q_.call(this,a,b,[c],e,f);this.Pa=d;this.F=Xg(d,5).concat(Xg(d,6));this.R=C(d,2);this.L=C(d,3);this.Aa=C(d,4);this.H=new DA;this.Fa(this.H)}t(wVf,q_);m=wVf.prototype;m.Cha=function(){var a=new Bk;L(a,21,4);var b=new Ck;L(b,1,this.F.length-1);vTe(a,b);return a};m.zS=ea("remove-duplicates");
m.Ga=function(){var a=this;q_.prototype.Ga.call(this);for(var b=this.Qf("waffle-inline-assistant-recommendation-container"),c={OO:0};c.OO<this.F.length;c={OO:c.OO},c.OO++){var d=b[c.OO];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.OO,h=a.Qf("waffle-inline-assistant-gridrange-chip")[f],k=a.F[f],l=new Jn(a.C[0].C,new jn(k,a.R,k+1,a.L));0===f?HW(a.J,l):HW(a.Na,l);$Uf(a);a.D.sK(k);ky(h,"waffle-inline-assistant-gridrange-chip-hovered")}}(c)).listen(d,"mouseleave",function(e){return function(){var f=
e.OO;f=a.Qf("waffle-inline-assistant-gridrange-chip")[f];GW(a.J);GW(a.Na);my(f,"waffle-inline-assistant-gridrange-chip-hovered");aVf(a)}}(c))}this.H.Ua(this.Ea("waffle-inline-assistant-accept-button"));yA(this.V,this.H,Zsb,zA,function(){return a},YUf(this))};
m.Ba=function(){for(var a=yM(this.C[0].rect),b=this.D.Ra(),c=[],d=this.R;5>d&&d<this.L;d++){var e=b.ah(this.F[0],d);c.push(XI(e))}b=Uy(NUf,{Bcc:this.F,Q2:c});this.jb(b);b={};this.Ha=(b.recommendationCategory="REMOVE_DUPLICATES",b.recommendationRange=a,b.recommendationFirstRow=(this.F[0]+1).toString(),b)};m.X6=function(){r_(this,!0)};m.nZ=function(){r_(this,!1);this.Ka().blur()};
m.e$=function(a,b){this.F[a]-=b;this.isVisible()&&(a=this.Qf("waffle-inline-assistant-gridrange-chip")[a],a.childNodes[0].nodeValue=(a.childNodes[0].nodeValue-b).toString())};m.t8=ba();m.AN=ba();function xVf(a,b,c,d,e,f){q_.call(this,a,b,c,e,f);this.R=d;this.Aa=Zc(Xg(d,1),function(h,k){return h+k},0);this.H=Yc(c,function(h){return h.rect.top});this.L=new DA;this.Fa(this.L)}t(xVf,q_);m=xVf.prototype;m.Cha=function(){var a=new Bk;L(a,21,2);var b=new Ck;L(b,1,this.H.length);vTe(a,b);return a};m.zS=ea("trim-whitespace");
m.Ba=function(){for(var a=this.C,b=[],c=[],d=ja(a),e=d.next();!e.done;e=d.next()){var f=e.value.rect;e=yM(f);var h=XI(this.D.Ra().ah(f.top,f.left));f=h.trimStart();var k=h.length-f.length,l=h.trim();f=f.length-l.length;h=[];for(var n=0;n<k;n++)h.push(null);k=!1;l=ja(l);for(n=l.next();!n.done;n=l.next())n=n.value,n.match("\\s")?k?(k=!1,h.push(null)):(k=!0,h.push(n)):h.push(n);for(k=0;k<f;k++)h.push(null);b.push(h);c.push(e)}b=Uy(GUf,{gT:c,Obb:b});this.jb(b);a=tM(a[0].rect.left);b={};this.Ha=(b.recommendationCategory=
"TRIM_WHITESPACE",b.recommendationRange=a,b.recommendationNumWhitespaces=this.Aa.toString(),b)};
m.Ga=function(){var a=this;q_.prototype.Ga.call(this);for(var b=this.Qf("waffle-inline-assistant-recommendation-container"),c={PO:0};c.PO<this.C.length;c={PO:c.PO},c.PO++){var d=b[c.PO];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.PO,h=a.C[f];HW(a.Na,h);$Uf(a);OP(a.D,h.rect.top,h.rect.left);h=a.Qf("waffle-inline-assistant-gridrange-chip")[f];ky(h,"waffle-inline-assistant-gridrange-chip-hovered");f=a.C[f];h=ritz_api.GridViewApi.previewRangeWithApplyTrimWhitespace(a.D.L.H,
LSe(f).ob());a.O=h;eKc(a.D,[f.rect])}}(c)).listen(d,"mouseleave",function(e){return function(){var f=e.PO;GW(a.Na);var h=a.Qf("waffle-inline-assistant-gridrange-chip")[f];my(h,"waffle-inline-assistant-gridrange-chip-hovered");a.O&&(ritz_api.GridViewApi.clearTransform(a.D.L.H,a.O),a.D.isDisposed()||(a.O=null,eKc(a.D,[a.C[f].rect])))}}(c))}this.L.Ua(this.Ea("waffle-inline-assistant-accept-button"));yA(this.V,this.L,$sb,zA,function(){return a},YUf(this))};m.X6=function(){r_(this,!0)};
m.nZ=function(){r_(this,!1);this.Ka().blur();aVf(this)};m.e$=function(a,b){var c=this.C[a];c=new Jn(c.C,new jn(c.rect.top-b,c.rect.left,c.rect.top-b+c.rect.height,c.rect.left+c.rect.width));this.C[a]=c;this.H[a]-=b;null!==this.Za("waffle-inline-assistant-gridrange-chip")&&(this.Qf("waffle-inline-assistant-gridrange-chip")[a].childNodes[0].nodeValue=yM(c.rect))};m.t8=ba();m.AN=ba();
m.Fra=function(a,b){for(var c=b.length-1;0<=c;c--)Xg(this.R,1).splice(b[c],1);return new xVf(this.bb,this.mb,a,this.R,this.Ya)};function yVf(a,b,c,d,e){Q.call(this,e);this.O=b;this.R=c;this.J=d;this.C=this.F=this.H=this.D=null;this.L=Uy(LUf)}t(yVf,Q);yVf.prototype.Ba=function(){Q.prototype.Ba.call(this);ky(this.getElement(),"waffle-inline-assistant-sidebar-section")};yVf.prototype.Ga=function(){Q.prototype.Ga.call(this);this.rb().appendChild(this.L)};
function zVf(a,b,c){a.C&&(a.removeChild(a.C,!0),a.C.dispose());if(c.length){var d=UJ(a.O);if(d){var e=d.Ra();d=[];for(var f={},h=0;h<b.length;h++){var k=b[h],l=c[h],n=k.rect,q=A1b(e.ah(n.top,n.left),e.Fb(),n.top,n.left),r=l+q+n.left,w=r in f?f[r].VF:[];w.push(k);f[r]={$J:l,UGa:q,VF:w,wcb:n.left}}b=AVf(f);c=ja(b.keys());for(e=c.next();!e.done;e=c.next())e=b.get(e.value),e=new bVf(a.R,a.O,e.VF,e.$J,e.Dma,e.mTa,a.J),d.push(e);d.sort(function(x,F){x=s_(x)[0];F=s_(F)[0];return x.left!=F.left?x.left-F.left:
x.top-F.top});a.C=new sVf("anomaly",d,"Fix invalid data",a.J);a.Fa(a.C)}}}function AVf(a){var b=new Map,c;for(c in a){var d=a[c];if(1<d.VF.length){var e=Array(d.VF.length).fill(d.UGa);b.set(c,{$J:d.$J,VF:d.VF,mTa:!0,Dma:e})}else{e="NON_BULK"+d.wcb+d.$J;var f=b.has(e)?b.get(e).VF:[];f.push(d.VF[0]);var h=b.has(e)?b.get(e).Dma:[];h.push(d.UGa);b.set(e,{$J:d.$J,VF:f,mTa:!1,Dma:h})}}return b}
function t_(a,b,c){var d=BVf(a,b.zS());if(c&&0<c.length){for(var e=d.C.indexOf(b),f=ka(b.C).concat(),h=c.length-1;0<=h;h--)f.splice(c[h],1);1<=f.length?(c=b.Fra(f,c),b.isVisible()&&(d.D.Cf(c,e,!0),d.D.removeChild(b,!0)),d.C[e]=c,b.dispose()):vVf(d,b)}else vVf(d,b);if(0===d.C.length)switch(b.zS()){case "number-format":a.D.dispose();a.D=null;break;case "trim-whitespace":a.H.dispose();a.H=null;break;case "remove-duplicates":a.F.dispose();a.F=null;break;case "anomaly":a.C.dispose(),a.C=null}}
function CVf(a){Rf(a.jd(!0));a.C=null;a.F=null;a.D=null;a.H=null}function DVf(a){return(a.C?a.C.C:[]).concat(a.F?a.F.C:[],a.D?a.D.C:[],a.H?a.H.C:[])}function BVf(a,b){switch(b){case "number-format":return a.D;case "trim-whitespace":return a.H;case "remove-duplicates":return a.F;case "anomaly":return a.C}}
function EVf(a,b){a=a||{};var c='<div class="'+T("waffle-inline-assistant-sidebar-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-column-filter-dropdown-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-column-filter-dropdown")+'" aria-label="';c+=Hx("Filter suggestions by column");c+='"></div></div><div class="'+T("waffle-inline-assistant-sidebar-empty-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-empty-message")+'">';c=c+'No suggestions available</div></div><div class="'+
(T("waffle-inline-assistant-sidebar-accepted-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-accepted-message")+'">');c=c+"Data cleanup suggestions have been applied</div>"+R(CA({Yc:"waffle-inline-assistant-sidebar-accept-back",content:"Back",style:2},b));c+="</div></div>";var d='<div class="'+T("waffle-inline-assistant-refresh-banner")+'"><div class="'+T("waffle-inline-assistant-refresh-text-container")+'"><div class="'+T("waffle-inline-assistant-refresh-text")+'">';d=d+'Refresh to see the latest suggestions.</div><div class="'+
(T("waffle-inline-assistant-refresh-button jfk-button-standard")+'">');d+="Refresh</div></div></div>";a=""+R(dX(Cx({title:"Data cleanup",ll:Fx(c),we:!0,id:"inlineassistant",$w:"waffle-inline-assistant-sidebar",tF:Fx('<img class="docs-icon docs-auto-fix" aria-hidden="true" src="https://www.gstatic.com/images/icons/material/system/1x/auto_fix_black_24dp.png"/>'),UV:!0,X4:Fx(d)},a),b));return S(a)}
function FVf(a){Q.call(this,a);this.D=new Q;this.Fa(this.D);this.J=FYe("");this.Fa(this.J);this.L=new wA(void 0,void 0,void 0,$B.getInstance());this.qa(this.L);this.F=new Mq(this.iYa,3E3,this);this.qa(this.F);this.C=null;this.H=0}t(FVf,Q);m=FVf.prototype;m.Ba=function(){var a=Uy(HUf);this.jb(a)};m.show=function(){var a=this.Ka();P(a,!0);my(a,"waffle-inline-assistant-sidebar-toast-hidden");this.F.start()};m.iYa=function(){ky(this.Ka(),"waffle-inline-assistant-sidebar-toast-hidden")};m.isVisible=function(){return hx(this.Ka())};
m.h5b=function(){this.F.stop()};m.i5b=function(){this.F.start(1E3)};function GVf(a,b){var c=Uy(IUf,{u6b:b});a.D.Ka().textContent=c.textContent;a.H=b}
m.Ga=function(){var a=this;Q.prototype.Ga.call(this);this.J.Ua(this.Ea("waffle-inline-assistant-toast-undo-button"));yA(this.L,this.J,Ysb,zA,void 0,function(){var c=new Bk;if(null!==a.C){L(c,21,a.C);var d=new Ck;L(d,1,a.H);vTe(c,d)}return zz(yz(vz(new uz,76),c))});this.D.Ua(this.Ea("waffle-inline-assistant-toast-text"));var b=this.Ka();this.getHandler().listen(this.J,"action",this.iYa).listen(b,"mouseenter",this.h5b).listen(b,"mouseleave",this.i5b)};
function HVf(a,b,c,d,e,f){IW.call(this,f);var h=this;this.L=b;this.ma=d;this.D=new yVf(a,b,c,e,f);this.Fa(this.D);this.O=bC(new aC);this.qa(this.O);this.R=new DA;this.Fa(this.R);yA(this.O,this.R,Gtb);this.H=new lW(new Mz);cA(this.H,"All columns");this.Fa(this.H);yA(this.O,this.H,Usb,this.H.J(),function(){return h.H.qf().getValue()});this.J=null;this.V=new DA;this.Fa(this.V);yA(this.O,this.V,atb);this.F=new FVf;this.Fa(this.F)}t(HVf,IW);
HVf.prototype.Ga=function(){var a=this;IW.prototype.Ga.call(this);this.getHandler().listen(this.Ka(),"click keyup keydown mousemove mouseover mouseenter mouseout".split(" "),function(){return void a.dispatchEvent("dataprep-sidebar-interaction-event")});G4e(this,!0);var b=this.Ea("waffle-inline-assistant-sidebar-empty-container");P(b,!1);b=this.Ea("waffle-inline-assistant-sidebar-accepted-container");P(b,!1);this.R.Ua(this.Ea("waffle-inline-assistant-sidebar-insights-cta"));this.H.render(this.Ea("waffle-inline-assistant-sidebar-column-filter-dropdown"));
this.V.Ua(this.Ea("waffle-inline-assistant-refresh-button"));IVf(this,!1)};HVf.prototype.Ba=function(){var a=Uy(EVf);this.jb(a);this.F.render(a);P(this.F.Ka(),!1);a=this.rb();this.D.render(a)};function JVf(a){if(z(y(),"fecei")&&null===a.J){var b=JV(a.L),c=UJ(a.L);a.J=ritz_api.GridViewApi.displayColumnErrorIcons(ritz_api.RitzModelApi.getTopLevelModel(),c.L.F,b);dXe(c)}}
function KVf(a){if(null!==a.J){var b=UJ(a.L);b&&(ritz_api.GridViewApi.clearColumnHeaderTransform(b.L.F,a.J),a.J=null,dXe(b),LRf(b,[]))}}HVf.prototype.setVisible=function(a){var b={};mB(this.ma,(b.Ke=a,b));b=UJ(this.L);this.isVisible()===a||!b&&a||(IW.prototype.setVisible.call(this,a),a?(G4e(this,!0),JVf(this),IVf(this,!1)):(CVf(this.D),KVf(this)))};
HVf.prototype.initialize=function(a,b,c,d,e,f,h,k,l){G4e(this,!1);CVf(this.D);var n=this.Ea("waffle-inline-assistant-sidebar-accepted-container");P(n,!1);n=this.Ea("waffle-inline-assistant-sidebar-empty-container");var q=this.Ea("waffle-inline-assistant-sidebar-column-filter-dropdown");if(a&&(b.length&&c.length||d.length&&e.length||f.length&&h.length||0!==k.length)){var r=new Mz,w=io(ritz_api.TablesApi.getTableGridRange(a));a=w.Kb();w=w.Qc();for(r.Fa(new Hz("All columns"),!0);a<w;a++)r.Fa(new Hz("Column "+
tM(a)),!0);r.setVisible(!1,!0);r.render();this.H.Ce(r);P(q,!0);P(n,!1);if(b.length&&c.length&&(n=this.D,n.D&&(n.removeChild(n.D,!0),n.D.dispose()),c.length)){q=[];for(r=0;r<c.length;r++)a=new oVf(n.R,n.O,b[r],c[r],n.J),q.push(a);n.D=new sVf("number-format",q,"Apply format to columns",n.J);n.Fa(n.D)}if(d.length&&e.length&&(b=this.D,b.H&&(b.removeChild(b.H,!0),b.H.dispose()),e.length)){c=[];for(n=0;n<e.length;n++)q=new xVf(b.R,b.O,d[n],e[n],b.J),c.push(q);b.H=new sVf("trim-whitespace",c,"Trim whitespace",
b.J);b.Fa(b.H)}if(f.length&&h.length&&(d=this.D,d.F&&(d.removeChild(d.F,!0),d.F.dispose()),h.length)){e=[];for(b=0;b<h.length;b++)c=new wVf(d.R,d.O,f[b],h[b],d.J),e.push(c);d.F=new sVf("remove-duplicates",e,"Remove duplicate rows",d.J);d.Fa(d.F)}0!==k.length&&zVf(this.D,k,l);f=this.D;f.F&&rx(f.F,f.L);f.C&&rx(f.C,f.L);f.D&&rx(f.D,f.L);f.H&&rx(f.H,f.L);JVf(this)}else P(n,!0),CVf(this.D),P(q,!1)};function LVf(a,b){var c=a.F;GVf(c,b);c.C=2;a.F.show()}
function MVf(a,b){var c=a.F;GVf(c,b);c.C=3;a.F.show()}function NVf(a,b){var c=a.F;b=Uy(JUf,{Bcb:b});c.D.Ka().textContent=b.textContent;c.C=1;c.H=0;a.F.show()}function OVf(a,b){var c=a.F,d=Uy(KUf,{x6b:b});c.D.Ka().textContent=d.textContent;c.C=4;c.H=b;a.F.show()}function IVf(a,b){a=a.Ea("waffle-inline-assistant-refresh-banner");P(a,b)}function PVf(a,b,c){PJ.call(this,150);this.gb=a;this.F=b;this.C=c}t(PVf,PJ);
PVf.prototype.Ed=function(){for(var a=new fSb,b=0;b<this.C.length;b++){var c=this.C[b],d=this.F[b],e=new yG,f=this.gb.Fb();d=mo(d,f);D(e,1,d);switch(c.H){case 32:c=c.Ed();D(e,7,c);break;case 134:c=c.Ed();D(e,4,c);break;case 138:c=c.Ed();D(e,3,c);break;case 1:c=c.Ed();D(e,2,c);break;case 151:c=c.Ed();D(e,6,c);break;case 55:c=c.Ed();D(e,5,c);break;default:continue}Ug(a,1,e)}return a};PVf.prototype.wg=ea(!1);
function QVf(a,b,c,d,e){VV.call(this,a,c);this.C=a;this.J=b;this.H=d;this.L=e;this.V=new p$e(b,e,a);this.qa(this.V);this.D=!1;this.F=new Mq(this.Jkb,2E3,this);this.qa(this.F);a=new uA(this);a.ub(Gtb,st,this.Szb);this.qa(a)}t(QVf,VV);m=QVf.prototype;m.initialize=function(a,b,c,d,e,f,h,k,l){this.C.initialize(a,b,c,d,e,f,h,k,l)};m.show=function(){WV(this)};
m.tL=function(){var a=new Bk;L(a,23,DVf(this.C.D).length);this.L.C(36588,zz(yz(vz(new uz,76),a)));a=ja(DVf(this.C.D));for(var b=a.next();!b.done;b=a.next())this.L.C(36583,YUf(b.value));KVf(this.C);VV.prototype.tL.call(this)};function RVf(a,b){var c=FM(a.J);if(c){var d=s_(b);c=new PVf(c,d,[new Hye(c,d[0],rVf(b))]);QJ(c,function(e){e&&a.F.start()});a.H.C(c);NVf(a.C,tM(d[0].left));t_(a.C.D,b,void 0)}}
function SVf(a,b){var c=FM(a.J);if(c){var d=s_(b)[0],e=new ph;qh(e,d.Kb());sh(e,d.Qc());c=new r$e(c,d,[e],b.Aa,b.F);QJ(c,function(f){f&&a.F.start()});a.H.C(c);OVf(a.C,b.F.slice(1,b.F.length).length);t_(a.C.D,b,void 0);TVf(a,b)}}function UVf(a,b){var c=FM(a.J);if(c){var d=s_(b);c=new PVf(c,d,d.map(function(){return new Iye}));QJ(c,function(e){e&&a.F.start()});a.H.C(c);LVf(a.C,d.length);t_(a.C.D,b,void 0)}}
function TVf(a,b){var c=DVf(a.C.D);b=b.F;for(var d=0;d<c.length;d++){var e=c[d],f=[];switch(e.zS()){case "remove-duplicates":f=e.F;break;case "trim-whitespace":f=e.H;break;case "anomaly":f=e.Va}for(var h=b.slice(1,b.length),k=[],l=0;l<f.length;l++){var n=sd(h,f[l]);0>n?(n=-1*(n+1),0<n&&e.e$(l,n)):k.push(l)}0<k.length&&t_(a.C.D,e,k)}}
function VVf(a,b,c,d){var e=FM(a.J);if(e){var f=new PVf(e,c,c.map(function(q){return new lzd(e,new Qm(q.left,q.top),d)}));QJ(f,function(q){q&&a.F.start()});a.H.C(f);MVf(a.C,c.length);f=s_(b);if(f.length===c.length)t_(a.C.D,b,void 0);else{for(var h=[],k=ja(c),l=k.next();!l.done;l=k.next()){l=l.value;for(var n=0;n<f.length;n++)if(f[n].equals(l)){h.push(n);break}}t_(a.C.D,b,h)}WVf(a,c)}}
function WVf(a,b){var c=DVf(a.C.D),d=b[0].left;b=Yc(b,function(n){return n.top});for(var e=0;e<c.length;e++){var f=c[e],h=[];switch(f.zS()){case "remove-duplicates":h=f.F;for(var k=0;k<h.length;k++)if(0<=sd(b,h[k])){t_(a.C.D,f,void 0);break}break;case "trim-whitespace":if(f.C[0].rect.left===d){h=f.H;k=[];for(var l=0;l<h.length;l++)0<=sd(b,h[l])&&k.push(l);t_(a.C.D,f,k)}}}}m.Szb=function(){Qf(this.V);m6b(!0)};m.isVisible=function(){return this.Wf().isVisible()};m.Wf=function(){return Qsb};m.Op=function(){return Rsb};
m.Jkb=function(){this.D=!1};
function XVf(a,b,c,d,e,f,h,k,l,n,q,r){A.call(this);var w=this;this.F=a;this.O=b;this.Oa=c;this.Wa=d;this.yb=e;this.ib=h;this.J=f;urc(this.J,this.F,this.yb,this.Wa);this.qb=k;this.Ya=l;this.mb=q;this.Bb=r;this.D=null;this.L=[];this.C=new kVf;this.Sa=this.V=this.Na=this.Ja=this.Ca=this.Pa=this.xa=!1;this.H=JV(this.O);this.Aa=new Map;this.R=new Mq(this.Nwa,void 0,this);this.qa(this.R);this.ma=null;this.bb=new Wo(this);this.qa(this.bb);this.Va=new mVf(a,b,c,this.Aa,this.C,this.L);this.Ha=0;this.bb.listen(this.J,
"recommender-calc-ended",this.W6).listen(this.J,"recommender-calc-failed",this.hrb).listen(RG(this.F.C),"Pb",this.iGb).listen(this.F.C,"na",this.e5b).listen(RG(this.F.C),"Dc",this.M2a).listen(this.mb.Na,"sheet-imported",this.d5b);this.fb=new uA(this);this.qa(this.fb);this.fb.ub(cD,st,this.$Pa).ub(Qsb,nt,function(x){x.newValue&&!w.Pa?w.$Pa():w.Pa=!1}).ub(Zsb,st,this.yGb).ub(Vsb,st,this.nDb).ub($sb,st,this.vLb).ub(Wsb,st,this.LJb).ub(Usb,st,this.QOa).ub(Xsb,st,this.gzb).ub(atb,st,this.hYa).ub(Ysb,st,
this.f5b);YVf(this)}t(XVf,A);m=XVf.prototype;m.yGb=function(a){this.D.D=!0;var b=a.data;SVf(this.D,b);a=this.C.V;b=a.indexOf(b.Pa);0>b||(a.splice(b,1),this.C.L.splice(b,1),this.C.C=null,this.C.D=null)};m.nDb=function(a){this.D.D=!0;var b=a.data;RVf(this.D,b);a=this.C.R;b=a.indexOf(b.Va);0>b||(a.splice(b,1),this.C.J.splice(b,1),this.C.C=null,this.C.D=null,ZVf(this))};
m.vLb=function(a){this.D.D=!0;var b=a.data;UVf(this.D,b);a=this.C.ma;b=a.indexOf(b.R);0>b||(a.splice(b,1),this.C.O.splice(b,1),this.C.C=null,this.C.D=null,ZVf(this))};m.LJb=function(a){this.D.D=!0;VVf(this.D,a.data.card,a.data.VGa,a.data.newValue);ZVf(this)};
function ZVf(a){if(z(y(),"fecei")){for(var b=new Set,c=ja(a.C.F),d=c.next();!d.done;d=c.next())d=d.value,1==Fn(d.rect,"c")&&b.add(d.rect.Kb());c=UJ(a.O);null!=c&&(LRf(c,Array.from(b)),(new Mq(function(){var e=UJ(a.O);e&&dXe(e)},300)).start())}}
m.QOa=function(){var a=this.D.C.H,b=a.qf().getValue(),c=a.Ka();a=gp("docs-material-gm-labeled-select-outer-box",c);c=gp("docs-material-gm-labeled-select-caption",c);"All columns"===b?($Vf(this),Rw(a,"background-color",""),Rw(c,"color","")):($Vf(this,kpc(b.slice(7))),Rw(a,"background-color","#E6F4EA"),Rw(c,"color","#188038"))};m.gzb=function(a){var b=a.data.card;if(1===b.Qf(b.x3()).length)t_(this.D.C.D,b,void 0);else{var c=this.D;a=a.data.Zfc;void 0===a?t_(c.C.D,b,void 0):t_(c.C.D,b,[a])}ZVf(this)};
function YVf(a){z(y(),"fedpsoi")&&a.Bb&&(a.ma=500,a.R.start(a.ma),a.Na=!0)}function aWf(a,b){return a.H?b.filter(function(c){c=no(HV(c));return c.C!=a.H?!1:JM(a.F,c.C||a.H,c.rect,!1)}):[]}m.d5b=function(a){a=a.Lh;if(zI(this.F.C,a)){var b=new kVf;this.Aa.set(a,b);a===this.H&&(this.C=b)}this.V=!0;YVf(this)};m.$Pa=function(){this.xa=!0;this.Nwa();bWf(this);cWf(this)};
function bWf(a){if(FM(a.F)){if(!a.D){var b=new HVf(a.F.F,a.O,a.F.L.C,a.ib,a.Oa);a.qa(b);b.render();a.D=new QVf(b,a.F,a.qb,a.Ya,a.Oa);a.qa(a.D)}a.Pa=!0;a.D.show()}}m.hYa=function(){this.C.C=null;this.Ca=!0;this.R.start(150);IVf(this.D.C,!1)};m.M2a=function(){dWf(this)&&(this.C.C=null,IVf(this.D.C,!0))};m.f5b=function(){Sme(this.Ya.D);this.C.C=null;this.hYa();this.Sa=!0};
function $Vf(a,b){a.xa=!1;a.Ja=!1;a.Na=!1;a.Ca=!1;cWf(a);var c=FM(a.F);if(c){var d=[];if(a.C.D&&(d=aWf(a,a.C.D.C),!a.H))return;var e=a.C.Ca,f=null;e?f=jVf(c,e.rect):(f=jVf(c,c.F))&&(e=KG(io(ritz_api.TablesApi.getTableGridRange(f))));e=[];var h=[],k=[],l=[],n=[],q=[];d=ja(d);for(var r=d.next();!r.done;r=d.next()){var w=r.value;r=no(HV(w));if(void 0===b||r.rect.left==b||9===C(w,1))switch(a.L.push(r),C(w,1)){case 7:var x=r.rect.left;if(ritz_api.RitzModelApi.getColumnType(c.Fb(),x))continue;w=C(w,14);
x=C(w,1);var F=w.getPattern();F=iVf(a.F.F,x,F);w.setPattern(F);l.push(w);e.push(r);break;case 8:r=C(w,15);n.push(r);h.push(Xg(w,4).map(no));break;case 9:w=C(w,16),q.push(w),k.push(r)}}r=a.C.F;w=a.C.H;c=[];d=[];if(void 0!==b)for(x=0;x<r.length;x++)r[x].rect.left==b&&(c.push(r[x]),d.push(w[x]));else c=r,d=w;bWf(a);a.D&&(r=a.F.F.F["ritz-DataPrepSuggestionsSidepaneCount"],r.setValue(r.getValue()+1),a.D.initialize(f,e,l,h,n,k,q,c,d),eWf(a,b),b=UJ(a.O),null!=b&&KRf(b,function(M){eWf(a,M);a.QOa()}),ZVf(a));
lVf(a.C,f,e,l,h,n,k,q)}}function eWf(a,b){void 0===b?a.D.C.H.Af(0):a.D.C.H.Af(b+1)}function dWf(a){return null!=a.D&&a.D.isVisible()}
m.e5b=function(a){if(this.H){var b=dWf(this);this.C.Aa=b;this.D&&(b=this.D,b.Wf().isVisible()&&("na"===a.type?JVf(b.C):"oa"===a.type&&b.tL()));this.Aa.set(this.H,this.C);this.L=[];this.V||(this.R&&this.R.stop(),this.ma=null);a=FM(this.F);null==a?(this.H=JV(this.O),this.C=new kVf):(this.H=a.Fb(),this.C=this.Aa.has(this.H)?this.Aa.get(this.H):new kVf);if(this.H){a=this.Va;b=this.H;var c=this.C,d=this.L;b&&c&&a.D&&(a.D=b,a.C=c,nVf(a,d));if(this.C.Aa){a=this.C.Ha;b=this.C.J;c=this.C.O;d=this.C.L;var e=
this.C.F;a&&(b.length||c.length||d.length||e.length)&&(bWf(this),this.D&&this.D.initialize(a,b,this.C.R,c,this.C.ma,d,this.C.V,this.C.F,this.C.H));ZVf(this)}}}};
m.iGb=function(a){if(a.C&&a.C.length)if(this.Sa)this.Sa=!1;else{var b=FM(this.F);if(!b)if(a.target instanceof jJ)b=a.target;else return;if(dWf(this)){if(this.D.D){b&&ZVf(this);return}var c=this.C.C;c&&a.C.some(function(e){return e.top<c.Oc()&&e.left<c.Qc()})&&this.M2a()}if(this.R.Cb()||dWf(this))this.ma=5E3,this.R.start(this.ma);b={};a=ja(a.C);for(var d=a.next();!d.done;b={p9:b.p9},d=a.next()){b.p9=d.value;if(!this.H)break;if(!this.C.C)break;if(CBa(this.C.C,b.p9)&&(!this.L||!this.L.some(function(e){return function(f){return e.p9.equals(f.rect)}}(b)))){this.C.C=
null;this.L=[];this.C.D=null;break}}}};m.hrb=function(){2<this.Ha?(this.Ha=0,this.W6(null)):(this.Ha++,this.Nwa())};
m.W6=function(a){this.V=!1;this.Ha=0;if(z(y(),"fenfts")||z(y(),"fetws")||z(y(),"ferds")||z(y(),"fecad")){var b=this.J.C,c=UJ(this.O);if(this.H)if(a&&c&&b&&this.H&&b.C===this.H?(this.C.D=a,this.C.C=b.rect):(this.C.D=null,this.C.C=null),this.C.Ca=b,this.xa||this.Ja||this.Ca)$Vf(this);else{var d=a?aWf(this,a.C):[];b=this.C.F.length;a=d.length+b;b=1<b;var e=c=0;d=ja(d);for(var f=d.next();!f.done;f=d.next())f=f.value,7==C(f,1)?(b=b||C(C(f,14),3),c++):9==C(f,1)&&(b=!0,e++);!b||0==e&&2>c||!this.Na||($Vf(this),
this.Oa.C(36702,fWf(this,a)))}}};function fWf(a,b){var c=new Bk;L(c,23,b);for(var d in WUf){b=new V8d;switch(WUf[d]){case "number-format":L(b,1,1);L(b,2,a.C.J.length);break;case "trim-whitespace":L(b,1,2);L(b,2,a.C.O.length);break;case "remove-duplicates":L(b,1,4);L(b,2,a.C.L.length);break;case "anomaly":L(b,1,3);L(b,2,a.C.F.length);break;default:continue}bk(c,25,b,V8d,void 0)}return zz(yz(vz(new uz,76),c))}function cWf(a){a.H&&IRf(a.F.F.J,a.F.D.F,a.H)}
m.Nwa=function(){if(this.H){if(!(this.V||this.xa||this.Ja||this.Ca)){var a=this.F.F.J;if(!Pj(a.C,2,!0))return;var b=this.F.D.F;a=ja(Xj(a.C,xT,1));for(var c=a.next();!c.done;c=a.next())if(c=c.value,b===K(c,1)&&this.H===c.hb())return}this.ma=null;b=FM(this.F);a=WJ(this.O);b&&!this.F.Ld()&&this.F.H.C&&!LM(this.F)&&a&&!a.F?(nVf(this.Va,this.L),a=b.F,(c=this.C.C)&&CBa(c,a)?(this.xa&&this.W6(this.C.D),this.V=!1):USe(this.J)?(this.J.reset(),IWe(this.J),(b=jVf(b,a))?(b=io(ritz_api.TablesApi.getTableGridRange(b)),
this.J.L=b,SWe(this.J,!0,!0,!1,[7,8,9])):this.W6(null)):this.W6(null)):this.V=!1}};function gWf(a,b,c,d,e,f,h,k,l,n,q){VV.call(this,b,h);var r=this;this.H=a;this.C=b;this.Ca=c;this.Pa=d;this.Na=e;this.L=f;this.D=c.C;this.Ja=this.Aa=!1;this.F=null;this.V=k;this.Oa=q;this.J=null;hWf(this);ltb.Ma(!0);a=new pk;L(a,6,iWf());b=new mk;qk(b,a);this.ma=zz(vz(wz(new uz,b),10));this.xa=-1;a=new Mq(function(){return jWf(r,!1)},100);this.qa(a);a.start()}t(gWf,VV);
function hWf(a){var b=RG(a.Na);a.La.listen(a.Pa,"selectionChange",a.hXb).listen(a.D,"na",a.gXb).listen(a.D,"xa",a.jXb).listen(b,"Pb",a.dQa).listen(a.C,"Yd",a.iqb).listen(a.C,"Xd",a.hqb).listen(a.C,"Wd",a.fqb).listen(a.C,"de",a.tGb).listen(a.C,"$d",a.Frb).listen(a.C,"he",a.KJb).listen(a.C,"ee",a.dIb).listen(a.C,"Zd",a.Gqb).listen(a.C,"ie",a.kXb).listen(a.H.C,"recommender-confidence-update",a.ktb).listen(a.C,"fe",a.iXb);Ct(Ct(Ct(Ct(Ct(Ct(Bt(a.O,mtb,(vt(),wt),function(){a.C.Xga(!mtb.isEnabled())}),otb,
function(){var c=a.C.isVisible();a.Wf().setVisible(!c);c||a.C.focus();kWf(a,!c)}),ntb,function(c){dUf(a.C,c.data)}),Jsb,function(){return lWf(a)}),Pvb,function(c){return mWf(a,c.data)}),PBb,function(){AUf(a.C,!0)}),hE,function(){return a.tL()})}m=gWf.prototype;m.Wf=function(){return ptb};m.Op=function(){return qtb};m.oy=function(a){VV.prototype.oy.call(this,a);ntb.Ma(a);jWf(this,!1);!this.Aa&&a&&(this.Aa=!0);var b={};mB(this.Oa,(b.Le=a,b));a||this.C.Jc()};
m.x6=function(a){var b=this;this.C.xAa();var c=new Mq(function(){VV.prototype.x6.call(b,a)},300);this.qa(c);c.start()};m.tL=function(){VV.prototype.tL.call(this);kWf(this,!1)};m.hWa=function(a){this.C.iWa(a);this.H.C.Ja=a};m.iqb=function(a){var b=a.C.H,c=C(C(b,13),3);b=HV(b);var d=new Fh;cke(d,c);var e=new ur;D(e,1,d);D(e,3,!0);GTe(e,!0);this.L.C(new w$e(e,b));u_(this,a.nk(),!1,P9e(Dh(c)))};function kWf(a,b){b?(u_(a,2253),a.xa=Ka()):u_(a,2226,!0)}function lWf(a){a.C.isVisible()||a.oy(!0)}
function mWf(a,b){var c="",d=void 0;b&&b.evt&&(c=b.evt?b.evt.C:"",d=b.evt);var e=yUf(a.C);e&&(e.Cb()?nTf(e,c,!0,!!c,d):(lWf(a),b=new Mq(function(){mTf(e,c,!0,!!c,d)},1E3),a.qa(b),b.start()))}m.jXb=function(){uV(this.H.C)||(this.H.C.reset(),jWf(this,!1))};m.hXb=function(){if(IM(this.Ca)&&null==this.C.O){var a=uV(this.H.C);a&&DI(this.D)!=a.hb()||jWf(this,!0)}};
function jWf(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.Ja.refresh(void 0),fUf(d));a.H.update(!b,a.C.isVisible(),c)}
m.ktb=function(a){var b=a.C,c=b?b.D:null;a=b?b.C:0;var d=!!b&&.9<=b.C,e=b?b.D.rect:null;e=!!e&&e.xi()>=pqb&&Fn(e,"r")>=rqb&&Fn(e,"c")>=sqb&&e.xi()<=qqb;b=!!b&&.6<=b.C&&e;if(b!==this.Ja||c&&!c.intersects(this.F))this.Ja=b,this.F=c,this.xa=Ka(),ltb.kb({efa:b,GC:c});e&&c&&c.rect&&(b=1E3>=c.rect.xi(),c=ritz_api.RitzModelApi.isFormsRegion(c.C,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Aa&&d&&b&&!eL(this.Ca.H),c=z(y(),"feeaof")&&c,b=z(y(),"feeaoro")&&
this.Ca.Ld(),d&&(c||b)&&(d=new pk,L(d,1,a),L(d,2,c),L(d,3,b),L(d,5,uqb),L(d,6,iWf()),a=new mk,qk(a,d),a=zz(wz(vz(new uz,10),a)),this.dGa(a)))};m.dGa=function(a){var b=this;if(HI(this.D)&&!zJ(KI(this.D))&&(this.C.dc=!0,!NC.Aca().C)){var c=a||this.ma;this.Wf().setVisible(!0);this.V.C(2225,c);u_(this,2253);a=new Mq(function(){b.C.isVisible()||b.V.C(2752,c)},5E3);this.qa(a);a.start()}};
function iWf(){switch(tqb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}m.Gqb=function(){this.C.Jc()};m.kXb=function(a){var b=a.C,c=HV(b.H);this.J=oo(c);Sme(this.L.D);yTf(b,c);u_(this,a.nk())};m.gXb=function(){HI(this.D)?(this.C.Ma(!0),this.H.C.reset(),jWf(this,!1)):(this.Wf().setVisible(!1),this.H.C.reset(),this.C.Ma(!1))};m.dQa=function(a){jWf(this,!1,yTb(a))};
m.hqb=function(a){var b=KI(this.D),c=b.Fb(),d=[],e=m$e(b);if(e){b=new Qr;var f=Yg(e,2);D(b,3,f);f=Yg(e,2);D(b,2,f);e=Yg(e,1);D(b,1,e);d.push(b)}b=a.C.Kd;for(e=0;e<b.length;e++)f=new Qr,D(f,2,b[e]),d.push(f);this.L.C(new v$e(d,c));u_(this,a.nk())};
m.fqb=function(a){var b=a.C,c=a$e(b.C),d=HV(b.H),e=c.Jy?c.IB:null,f=c.C?c.oB:null,h=d.hb(),k=nWf(d);this.J=oo(d);k?(c=new y$e(k,h,this.J,e,c.zx,c.Fy,f),QJ(c,function(l){l&&a.D.call()}),this.L.C(c)):(c=new t$e(h,this.J,e,c.zx,c.Fy,f),QJ(c,function(l){l&&a.D.call()}),this.L.C(c));d=new FPd;L(d,1,1);c=new XS;rTe(c,C(b.H,2));Yj(c,5,d);b=Z1e(this.F,DI(this.D));xV(b,c);b=zz(wz(vz(new uz,10),b));this.V.C(a.nk(),b)};
m.tGb=function(a){var b=a.C,c=HV(b.H),d=nWf(c);this.J=oo(c);d=new u$e(d);QJ(d,function(e){e&&a.D.call();yTf(b,c)});this.L.C(d)};m.iXb=function(a){var b=LSe(a.D),c=hSf(b,a.F,a.O),d=this.H,e=a.F;IWe(d.C);d.C.L=b;d.C.Aa=c;d.C.Ca=e;SWe(d.C,!0,!0,!1);u_(this,a.nk());a.D.C!=DI(this.D)&&(c=LI(this.D,a.D.C))&&(c=RG(c),this.La.listen(c,"Pb",this.dQa));a.L&&(yUf(this.C)&&yUf(this.C).mS(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.Ja.refresh(b),fUf(a)))};
function nWf(a){var b=a.hb();a=oo(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.Lb(),a.Kb(),a.Oc(),a.Qc(),7,!1);return 0<b.length?b[0]:null}m.Frb=function(a){var b=a.Sa;AI(KI(this.D),b);u_(this,a.nk())};
m.KJb=function(a){var b=a.C;a=a.nk();if(b instanceof RW||b instanceof G8e||b instanceof LTf)u_(this,a,void 0,void 0,b.WK());else{var c=eUf(this.C),d=new XS,e=C(b.H,2);c=c.indexOf(b);L(d,1,c);rTe(d,e);e=new mk;xV(e,d);if(b instanceof KSf){(d=b.D)?(b=oWf(this,b,d),b=Eyd(b,d,d.Il)):b=null;if(!b)return;Yj(e,39,b)}else if(b instanceof dTf){var f=b.H;c=new DPd;if(b instanceof dTf)b=1;else throw Error("Unknown text analysis card type.");f=Xg(IV(f),20).slice(0,10);L(c,2,f||[]);L(c,1,b);Yj(d,3,c)}e=zz(wz(vz(new uz,
10),e));this.V.C(a,e)}};m.dIb=function(){this.C.Jc()};function oWf(a,b,c){a=eUf(a.C).filter(function(f){return f instanceof KSf});var d=a.map(function(f){return f.ye()}),e=a[0]&&C(a[0].J,29);return Cyd(c,a.indexOf(b),b.D&&b.D.Ne(),d,e)}
function u_(a,b,c,d,e){e=void 0===e?10:e;if(a.F){var f=N(N(Gk(a.ma),pk,58),Msa,7);if(c||!f||f.hb()!=a.F.C||f.Kb()!=a.F.rect.Kb()||f.Lb()!=a.F.rect.Lb()||f.Qc()!=a.F.rect.Qc()||f.Oc()!=a.F.rect.Oc()){f=new pk;L(f,6,iWf());var h=Y1e(a.F);Yj(f,7,h);c&&(c=Ka()-a.xa,L(f,8,1E3*c),null!=a.C.yb&&(c=Ka()-a.C.yb,L(f,10,1E3*c)));d&&tTe(f,d);d=new mk;qk(d,f);a.ma=zz(vz(wz(new uz,d),e))}}a.V.C(b,a.ma)}function pWf(){GJ.apply(this,arguments)}t(pWf,GJ);m=pWf.prototype;m.Kmb=function(){return PTf};m.tlb=function(){return wUf};
m.imb=function(){return XVf};m.$lb=function(){return rSf};m.slb=function(){return gWf};m.mlb=function(){return kSf};m.bmb=function(){return eSf};KJ("assistant",pWf);
